<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta name="baidu-site-verification" content="UqlC4pwKIm">
  <meta name="baidu-site-verification" content="d3U0dGeqGw">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="google-site-verification" content="1C1XSuJ8TgM2O0mcZvsgzEdy0IdRZOJfxDYPyh18U9Q">














  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.cat.net/css?family=Roboto Slab:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="Mybatis-Plus 我来填坑~简介：​    此Demo 主要应用SpringBoot 来展示Mybatis-Plus 特性， 以及在开发过程中可能应用到的插件的演示。 ​    源码：https://github.com/wunian7yulian/MybatisPlusDemo ​    本文：https://wunian7yulian.github.io/MybatisPlusDemo">
<meta property="og:type" content="article">
<meta property="og:title" content="&#39;MyBatis-Plus我来填坑&#39;">
<meta property="og:url" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/index.html">
<meta property="og:site_name" content="WUNIAN7YULIAN">
<meta property="og:description" content="Mybatis-Plus 我来填坑~简介：​    此Demo 主要应用SpringBoot 来展示Mybatis-Plus 特性， 以及在开发过程中可能应用到的插件的演示。 ​    源码：https://github.com/wunian7yulian/MybatisPlusDemo ​    本文：https://wunian7yulian.github.io/MybatisPlusDemo">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://mp.baomidou.com/img/logo.png">
<meta property="og:image" content="https://mp.baomidou.com/img/relationship-with-mybatis.png">
<meta property="og:image" content="https://mp.baomidou.com/img/mybatis-plus-framework.jpg">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1546839886488.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1546926876784.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1546926951091.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1546927063917.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1546927538730.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1546932099260.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1547002387987.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1547011199397.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1547021955044.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1547101878214.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1547103652530.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1547104354429.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1547104548508.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1547104637008.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1547174994254.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1547175323184.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1547179827539.png">
<meta property="og:image" content="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/1547179917168.png">
<meta property="og:updated_time" content="2019-04-04T08:45:35.973Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="&#39;MyBatis-Plus我来填坑&#39;">
<meta name="twitter:description" content="Mybatis-Plus 我来填坑~简介：​    此Demo 主要应用SpringBoot 来展示Mybatis-Plus 特性， 以及在开发过程中可能应用到的插件的演示。 ​    源码：https://github.com/wunian7yulian/MybatisPlusDemo ​    本文：https://wunian7yulian.github.io/MybatisPlusDemo">
<meta name="twitter:image" content="https://mp.baomidou.com/img/logo.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/">





  <title>'MyBatis-Plus我来填坑' | WUNIAN7YULIAN</title>
  







</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">WUNIAN7YULIAN</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">lynwood wunian7yulian</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            时光轴
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wunian7yulian">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WUNIAN7YULIAN">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">'MyBatis-Plus我来填坑'</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-04T16:24:36+08:00">
                2019-04-04
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2019-04-04T16:45:35+08:00">
                2019-04-04
              </time>
            
          </span>

          

          
            
          

          
          
             <span id="/2019/04/04/MyBatis-Plus我来填坑/" class="leancloud_visitors" data-flag-title="'MyBatis-Plus我来填坑'">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  10.3k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  48 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Mybatis-Plus-我来填坑"><a href="#Mybatis-Plus-我来填坑" class="headerlink" title="Mybatis-Plus 我来填坑~"></a>Mybatis-Plus 我来填坑~</h1><h4 id="简介："><a href="#简介：" class="headerlink" title="简介："></a>简介：</h4><p>​    此Demo 主要应用SpringBoot 来展示<strong>Mybatis-Plus</strong> 特性， 以及在开发过程中可能应用到的插件的演示。</p>
<p>​    <strong>源码：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3d1bmlhbjd5dWxpYW4vTXliYXRpc1BsdXNEZW1v" title="https://github.com/wunian7yulian/MybatisPlusDemo">https://github.com/wunian7yulian/MybatisPlusDemo<i class="fa fa-external-link"></i></span></strong></p>
<p>​    <strong>本文：<span class="exturl" data-url="aHR0cHM6Ly93dW5pYW43eXVsaWFuLmdpdGh1Yi5pby9NeWJhdGlzUGx1c0RlbW8v" title="https://wunian7yulian.github.io/MybatisPlusDemo/">https://wunian7yulian.github.io/MybatisPlusDemo/<i class="fa fa-external-link"></i></span></strong></p>
<hr>
<ul>
<li><p><strong>相同于 <span class="exturl" data-url="aHR0cHM6Ly9teWJhdGlzLnBsdXMvZ3VpZGUv" title="https://mybatis.plus/guide/">MyBatis官方指南<i class="fa fa-external-link"></i></span> 中有了详细介绍</strong></p>
<p><strong>不同于 实践演示</strong>    </p>
</li>
</ul>
<hr>
<ul>
<li><p><strong>目的:</strong></p>
<p>主要借此做为突破口， <strong>一是</strong>将自我学习成文记录下来， <strong>二是</strong>将Demo 慢慢做成一个自己或者面向大众的后端脚手架工具。</p>
</li>
<li><p><strong>规划</strong>：</p>
<p><em>分享-实践-填坑-总结-脚手架-分享-实践……</em>  </p>
<p>​    </p>
</li>
</ul>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><p>[TOC]</p>
<h2 id="一、简单介绍"><a href="#一、简单介绍" class="headerlink" title="一、简单介绍"></a>一、简单介绍</h2><p><img src="https://mp.baomidou.com/img/logo.png" alt="mybatis-plus图像"></p>
<h3 id="官方说明-："><a href="#官方说明-：" class="headerlink" title="官方说明 ："></a>官方说明 ：</h3><p>Mybatis-Plus（简称MP）是一个Mybatis的增强工具，在 Mybatis 的基础上只做增强不做改变，为简化开发而生！</p>
<ul>
<li><h4 id="润物无声"><a href="#润物无声" class="headerlink" title="润物无声"></a>润物无声</h4><p>只做增强不做改变，引入它不会对现有工程产生影响。</p>
</li>
<li><h4 id="效率至上"><a href="#效率至上" class="headerlink" title="效率至上"></a>效率至上</h4><p>只需简单配置，即可快速进行 CRUD 操作，从而节省大量时间。</p>
</li>
<li><h4 id="丰富功能"><a href="#丰富功能" class="headerlink" title="丰富功能"></a>丰富功能</h4><p>热加载、代码生成、分页、性能分析等功能一应俱全。</p>
</li>
</ul>
<h3 id="成绩："><a href="#成绩：" class="headerlink" title="成绩："></a>成绩：</h3><p>MyBatis-Plus 荣获<span class="exturl" data-url="aHR0cHM6Ly93d3cub3NjaGluYS5uZXQvcXVlc3Rpb24vMjg5Njg3OV8yMjkwMzAw" title="https://www.oschina.net/question/2896879_2290300">【2018年度开源中国最受欢迎的中国软件】<i class="fa fa-external-link"></i></span> TOP5     ​    </p>
<h3 id="最新版本："><a href="#最新版本：" class="headerlink" title="最新版本："></a>最新版本：</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.7.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="开发层面MyBatis-Plus特色"><a href="#开发层面MyBatis-Plus特色" class="headerlink" title="开发层面MyBatis-Plus特色"></a>开发层面MyBatis-Plus特色</h3><ol>
<li><strong>代码生成</strong></li>
<li><strong>条件构造器</strong></li>
</ol>
<h3 id="Mybatis-Plus中的Plus"><a href="#Mybatis-Plus中的Plus" class="headerlink" title="Mybatis-Plus中的Plus"></a>Mybatis-Plus中的Plus</h3><p><img src="https://mp.baomidou.com/img/relationship-with-mybatis.png" alt="like">官方简介说明 MP 和Mybatis 就像是 游戏中的p1 和p2 一样 兄弟搭配 干活不累 、</p>
<p>我在使用中明显感觉到 其实他更像是 马里奥和蘑菇  吃了蘑菇 我们跳的高度更高了一些。</p>
<h2 id="二、MP的特性"><a href="#二、MP的特性" class="headerlink" title="二、MP的特性"></a>二、MP的特性</h2><ul>
<li><strong>无侵入</strong>：只做增强不做改变，引入它不会对现有工程产生影响，如丝般顺滑</li>
<li><strong>损耗小</strong>：启动即会自动注入基本 CURD，性能基本无损耗，直接面向对象操作</li>
<li><strong>强大的 CRUD 操作</strong>：内置通用 Mapper、通用 Service，仅仅通过少量配置即可实现单表大部分 CRUD 操作，更有强大的条件构造器，满足各类使用需求</li>
<li><strong>支持 Lambda 形式调用</strong>：通过 Lambda 表达式，方便的编写各类查询条件，无需再担心字段写错</li>
<li><strong>内置代码生成器</strong>：采用代码或者 Maven 插件可快速生成 Mapper 、 Model 、 <strong>Service 、 Controller</strong> 层代码，支持模板引擎，更有超多自定义配置等您来使用</li>
<li><strong>内置分页插件</strong>：基于 MyBatis 物理分页，开发者无需关心具体操作，配置好插件之后，写分页等同于普通 List 查询</li>
<li><strong>内置全局拦截插件</strong>：提供全表 delete 、 update 操作智能分析阻断，也可自定义拦截规则，预防误操作</li>
<li><strong>支持多种数据库</strong>：支持 MySQL、MariaDB、Oracle、DB2、H2、HSQL、SQLite、Postgre、SQLServer2005、SQLServer 等多种数据库</li>
<li><strong>支持主键自动生成</strong>：支持多达 4 种主键策略（<code>内含分布式唯一 ID 生成器 - Sequence</code>），可自由配置，完美解决主键问题</li>
<li><strong>支持 XML 热加载</strong>：<u>Mapper 对应的 XML 支持热加载，对于简单的 CRUD 操作</u>，甚至可以无 XML 启动</li>
<li><strong>支持 ActiveRecord 模式</strong>：支持 ActiveRecord 形式调用，实体类只需继承 Model 类即可进行强大的 CRUD 操作</li>
<li><strong>支持自定义全局通用操作</strong>：支持全局通用方法注入（ Write once, use anywhere ）</li>
<li><strong>支持关键词自动转义</strong>：支持数据库关键词（order、key……）自动转义，还可自定义关键词</li>
<li><strong>内置性能分析插件</strong>：可输出 Sql 语句以及其执行时间，建议开发测试时启用该功能，能快速揪出慢查询</li>
<li><strong>内置 Sql 注入剥离器</strong>：支持 Sql 注入剥离，有效预防 Sql 注入攻击</li>
</ul>
<h2 id="三、MP框架结构"><a href="#三、MP框架结构" class="headerlink" title="三、MP框架结构"></a>三、MP框架结构</h2><p><img src="https://mp.baomidou.com/img/mybatis-plus-framework.jpg" alt="框架"></p>
<h2 id="四、简单的入门Demo-Mysql"><a href="#四、简单的入门Demo-Mysql" class="headerlink" title="四、简单的入门Demo(Mysql)"></a>四、简单的入门Demo(Mysql)</h2><h4 id="Demo代码地址："><a href="#Demo代码地址：" class="headerlink" title="Demo代码地址："></a>Demo代码地址：</h4><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3d1bmlhbjd5dWxpYW4vTXliYXRpc1BsdXNEZW1vL3RyZWUvbWFzdGVyL3NpbXBsZWRlbW8=" title="https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/simpledemo">https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/simpledemo<i class="fa fa-external-link"></i></span></p>
<h4 id="Demo-环境："><a href="#Demo-环境：" class="headerlink" title="Demo 环境："></a>Demo 环境：</h4><p>​    windows 7</p>
<p>​    jdk 1.8.0.40</p>
<p>​    idea Ultimate </p>
<p>​    maven 3.3.9    </p>
<h4 id="初始化："><a href="#初始化：" class="headerlink" title="初始化："></a>初始化：</h4><h5 id="数据库：MySql"><a href="#数据库：MySql" class="headerlink" title="数据库：MySql"></a>数据库：MySql</h5><p>创建数据库<code>mp_demo_db</code>设置字符集 utf-8</p>
<h6 id="DDL"><a href="#DDL" class="headerlink" title="DDL:"></a>DDL:</h6><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建简单表格</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="keyword">user</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`user`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT  <span class="keyword">COMMENT</span> <span class="string">'主键ID'</span>,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'姓名'</span>,</span><br><span class="line">  <span class="string">`age`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'年龄'</span>,</span><br><span class="line">  <span class="string">`email`</span> <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'邮箱'</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure>
<h6 id="DML"><a href="#DML" class="headerlink" title="DML:"></a>DML:</h6><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 初始化数据</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="keyword">user</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">user</span> (<span class="keyword">id</span>, <span class="keyword">name</span>, age, email) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>, <span class="string">'Jone'</span>, <span class="number">18</span>, <span class="string">'test1@baomidou.com'</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="string">'Jack'</span>, <span class="number">20</span>, <span class="string">'test2@baomidou.com'</span>),</span><br><span class="line">(<span class="number">3</span>, <span class="string">'Tom'</span>, <span class="number">28</span>, <span class="string">'test3@baomidou.com'</span>),</span><br><span class="line">(<span class="number">4</span>, <span class="string">'Sandy'</span>, <span class="number">21</span>, <span class="string">'test4@baomidou.com'</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="string">'Billie'</span>, <span class="number">24</span>, <span class="string">'test5@baomidou.com'</span>);</span><br></pre></td></tr></table></figure>
<h4 id="工程："><a href="#工程：" class="headerlink" title="工程："></a>工程：</h4><p>​    为了方便快捷 选用 SpringBoot 工程作为Demo支撑</p>
<h5 id="第一步、创建工程"><a href="#第一步、创建工程" class="headerlink" title="第一步、创建工程"></a>第一步、创建工程</h5><p><img src="/2019/04/04/MyBatis-Plus我来填坑/1546839886488.png" alt="1546839886488"></p>
<p>输入项目包名 并<strong>添加mysql模块</strong> 创建完毕。</p>
<h5 id="第二步、引入依赖坐标"><a href="#第二步、引入依赖坐标" class="headerlink" title="第二步、引入依赖坐标"></a>第二步、引入依赖坐标</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.7.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--手动添加模板引擎--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.freemarker<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>freemarker<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.7.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="第三步、配置数据源"><a href="#第三步、配置数据源" class="headerlink" title="第三步、配置数据源"></a>第三步、配置数据源</h5><p>在 <code>application.yml</code> 配置文件中添加相关配置：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DataSource Config</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  datasource:</span></span><br><span class="line">    <span class="comment"># 这里如果有错误是因为 maven mysql包 选择了 runtime 形式的 scope  可以不用管它 继续下一步就好</span></span><br><span class="line"><span class="attr">    driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">jdbc:mysql://127.0.0.1:3306/mp_demo_db?characterEncoding=utf8</span></span><br><span class="line"><span class="attr">    username:</span> <span class="string">root</span></span><br><span class="line"><span class="attr">    password:</span> <span class="number">123456</span></span><br></pre></td></tr></table></figure>
<h5 id="第四步、添加mybatis扫描位置"><a href="#第四步、添加mybatis扫描位置" class="headerlink" title="第四步、添加mybatis扫描位置"></a>第四步、添加mybatis扫描位置</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan</span>(<span class="string">"com.lynwood.mp.simpledemo.mapper"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpledemoApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(SimpledemoApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="第五步、pojo及mapper"><a href="#第五步、pojo及mapper" class="headerlink" title="第五步、pojo及mapper"></a>第五步、pojo及mapper</h5><p>pojo:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>mapper:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper;</span><br><span class="line"><span class="keyword">import</span> com.lynwood.mp.simpledemo.model.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="第六步、测试"><a href="#第六步、测试" class="headerlink" title="第六步、测试"></a>第六步、测试</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SampleTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelect</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">        Assert.assertEquals(<span class="number">5</span>, userList.size());</span><br><span class="line">        userList.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">User&#123;id=<span class="number">1</span>, name=<span class="string">'Jone'</span>, age=<span class="number">18</span>, email=<span class="string">'test1@baomidou.com'</span>&#125;</span><br><span class="line">User&#123;id=<span class="number">2</span>, name=<span class="string">'Jack'</span>, age=<span class="number">20</span>, email=<span class="string">'test2@baomidou.com'</span>&#125;</span><br><span class="line">User&#123;id=<span class="number">3</span>, name=<span class="string">'Tom'</span>, age=<span class="number">28</span>, email=<span class="string">'test3@baomidou.com'</span>&#125;</span><br><span class="line">User&#123;id=<span class="number">4</span>, name=<span class="string">'Sandy'</span>, age=<span class="number">21</span>,email=<span class="string">'test4@baomidou.com'</span>&#125;</span><br><span class="line">User&#123;id=<span class="number">5</span>, name=<span class="string">'Bill'</span>, age=<span class="number">24</span>,email=<span class="string">'test5@baomidou.com'</span>&#125;</span><br></pre></td></tr></table></figure>
<h2 id="五、核心功能"><a href="#五、核心功能" class="headerlink" title="五、核心功能"></a>五、核心功能</h2><h3 id="核心一-简便之-代码生成器（AutoGenerator）"><a href="#核心一-简便之-代码生成器（AutoGenerator）" class="headerlink" title="核心一-简便之-代码生成器（AutoGenerator）"></a>核心一-简便之-代码生成器（AutoGenerator）</h3><p>​    AutoGenerator 是 MyBatis-Plus 的代码生成器，通过 AutoGenerator 可以快速生成 Entity、Mapper、Mapper XML、Service、Controller 等各个模块的代码，极大的提升了开发效率。</p>
<h4 id="Demo代码地址：-1"><a href="#Demo代码地址：-1" class="headerlink" title="Demo代码地址："></a>Demo代码地址：</h4><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3d1bmlhbjd5dWxpYW4vTXliYXRpc1BsdXNEZW1vL3RyZWUvbWFzdGVyL3NpbXBsZWRlbW8=" title="https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/simpledemo">https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/simpledemo<i class="fa fa-external-link"></i></span></p>
<h4 id="Demo-环境：-1"><a href="#Demo-环境：-1" class="headerlink" title="Demo 环境："></a>Demo 环境：</h4><p>​    同上</p>
<h4 id="工程：-1"><a href="#工程：-1" class="headerlink" title="工程："></a>工程：</h4><p>​    </p>
<h5 id="第一步、创建模块"><a href="#第一步、创建模块" class="headerlink" title="第一步、创建模块"></a>第一步、创建模块</h5><p>​    创建了autogenerator_demo模块（记得<strong>添加mysql模块</strong> ）作为演示代码生成器功能配置。</p>
<h5 id="第二步、引入依赖坐标-1"><a href="#第二步、引入依赖坐标-1" class="headerlink" title="第二步、引入依赖坐标"></a>第二步、引入依赖坐标</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.7.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--手动添加模板引擎--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.freemarker<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>freemarker<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：MP <code>3.0.3</code> 之后移除了自动模板引擎依赖，需要<strong>手动添加</strong>对应<strong>模板引擎</strong></p>
<h5 id="第三步、编写代码生成器"><a href="#第三步、编写代码生成器" class="headerlink" title="第三步、编写代码生成器"></a>第三步、编写代码生成器</h5><p>​    直接复制就行啦！</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lynwood.mp.autogenerator_demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.exceptions.MybatisPlusException;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.toolkit.StringPool;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.toolkit.StringUtils;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.AutoGenerator;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.InjectionConfig;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.*;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.po.TableInfo;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.engine.FreemarkerTemplateEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">//注意引入GlobalConfig 使用 import com.baomidou.mybatisplus.generator.config.*;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GeneratorCode</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 读取控制台内容</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">scanner</span><span class="params">(String tip)</span> </span>&#123;</span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        StringBuilder help = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        help.append(<span class="string">"请输入"</span> + tip + <span class="string">"："</span>);</span><br><span class="line">        System.out.println(help.toString());</span><br><span class="line">        <span class="keyword">if</span> (scanner.hasNext()) &#123;</span><br><span class="line">            String ipt = scanner.next();</span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isNotEmpty(ipt)) &#123;</span><br><span class="line">                <span class="keyword">return</span> ipt;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> MybatisPlusException(<span class="string">"请输入正确的"</span> + tip + <span class="string">"！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 代码生成器</span></span><br><span class="line">        AutoGenerator mpg = <span class="keyword">new</span> AutoGenerator();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 全局配置</span></span><br><span class="line">        GlobalConfig gc = <span class="keyword">new</span> GlobalConfig();</span><br><span class="line">        String projectPath = System.getProperty(<span class="string">"user.dir"</span>);</span><br><span class="line">        gc.setOutputDir(projectPath + <span class="string">"/src/main/java"</span>);</span><br><span class="line">        gc.setAuthor(<span class="string">"Lynwood"</span>);</span><br><span class="line">        gc.setOpen(<span class="keyword">false</span>);</span><br><span class="line">        mpg.setGlobalConfig(gc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 数据源配置</span></span><br><span class="line">        DataSourceConfig dsc = <span class="keyword">new</span> DataSourceConfig();</span><br><span class="line">        dsc.setUrl(<span class="string">"jdbc:mysql://127.0.0.1:3306/mp_demo_db?useUnicode=true&amp;useSSL=false&amp;characterEncoding=utf8"</span>);</span><br><span class="line">        <span class="comment">// dsc.setSchemaName("public");</span></span><br><span class="line">        dsc.setDriverName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">        dsc.setUsername(<span class="string">"root"</span>);</span><br><span class="line">        dsc.setPassword(<span class="string">"123456"</span>);</span><br><span class="line">        mpg.setDataSource(dsc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 包配置</span></span><br><span class="line">        PackageConfig pc = <span class="keyword">new</span> PackageConfig();</span><br><span class="line">        pc.setModuleName(scanner(<span class="string">"模块名"</span>));</span><br><span class="line">        pc.setParent(<span class="string">"com.lynwood.mp.autogenerator_demo"</span>);</span><br><span class="line">        mpg.setPackageInfo(pc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 自定义配置</span></span><br><span class="line">        InjectionConfig cfg = <span class="keyword">new</span> InjectionConfig() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="comment">// to do nothing</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果模板引擎是 freemarker</span></span><br><span class="line">        String templatePath = <span class="string">"/templates/mapper.xml.ftl"</span>;</span><br><span class="line">        <span class="comment">// 如果模板引擎是 velocity</span></span><br><span class="line">        <span class="comment">// String templatePath = "/templates/mapper.xml.vm";</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 自定义输出配置</span></span><br><span class="line">        List&lt;FileOutConfig&gt; focList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">// 自定义配置会被优先输出</span></span><br><span class="line">        focList.add(<span class="keyword">new</span> FileOutConfig(templatePath) &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">outputFile</span><span class="params">(TableInfo tableInfo)</span> </span>&#123;</span><br><span class="line">                <span class="comment">// 自定义输出文件名</span></span><br><span class="line">                <span class="keyword">return</span> projectPath + <span class="string">"/src/main/resources/mapper/"</span> + pc.getModuleName()</span><br><span class="line">                        + <span class="string">"/"</span> + tableInfo.getEntityName() + <span class="string">"Mapper"</span> + StringPool.DOT_XML;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        cfg.setFileOutConfigList(focList);</span><br><span class="line">        mpg.setCfg(cfg);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 配置模板</span></span><br><span class="line">        TemplateConfig templateConfig = <span class="keyword">new</span> TemplateConfig();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 配置自定义输出模板</span></span><br><span class="line">        <span class="comment">// templateConfig.setEntity();</span></span><br><span class="line">        <span class="comment">// templateConfig.setService();</span></span><br><span class="line">        <span class="comment">// templateConfig.setController();</span></span><br><span class="line"></span><br><span class="line">        templateConfig.setXml(<span class="keyword">null</span>);</span><br><span class="line">        mpg.setTemplate(templateConfig);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 策略配置</span></span><br><span class="line">        StrategyConfig strategy = <span class="keyword">new</span> StrategyConfig();</span><br><span class="line">        strategy.setNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">        strategy.setColumnNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">        strategy.setSuperEntityClass(<span class="keyword">null</span>);</span><br><span class="line">        strategy.setEntityLombokModel(<span class="keyword">true</span>);</span><br><span class="line">        strategy.setRestControllerStyle(<span class="keyword">true</span>);</span><br><span class="line">        strategy.setSuperControllerClass(<span class="keyword">null</span>);</span><br><span class="line">        strategy.setInclude(scanner(<span class="string">"表名"</span>));</span><br><span class="line">        strategy.setSuperEntityColumns(<span class="keyword">null</span>);</span><br><span class="line">        strategy.setControllerMappingHyphenStyle(<span class="keyword">true</span>);</span><br><span class="line">        strategy.setTablePrefix(pc.getModuleName() + <span class="string">"_"</span>);</span><br><span class="line">        mpg.setStrategy(strategy);</span><br><span class="line">        mpg.setTemplateEngine(<span class="keyword">new</span> FreemarkerTemplateEngine());</span><br><span class="line">        mpg.execute();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="第四步、运行测试"><a href="#第四步、运行测试" class="headerlink" title="第四步、运行测试"></a>第四步、运行测试</h5><p><img src="/2019/04/04/MyBatis-Plus我来填坑/1546926876784.png" alt="1546926876784"></p>
<p>在控制台输入：</p>
<p><img src="/2019/04/04/MyBatis-Plus我来填坑/1546926951091.png" alt="1546926951091"></p>
<p>就可以生成代码啦！  </p>
<p>都包含 ：</p>
<p><img src="/2019/04/04/MyBatis-Plus我来填坑/1546927063917.png" alt="1546927063917"></p>
<h5 id="发现问题：-如果是多模块项目-生成的文件会直接到了父项目目录下"><a href="#发现问题：-如果是多模块项目-生成的文件会直接到了父项目目录下" class="headerlink" title="发现问题： 如果是多模块项目 生成的文件会直接到了父项目目录下"></a><strong>发现问题</strong>： 如果是多模块项目 生成的文件会直接到了父项目目录下</h5><p>​    原因是：在代码的全局配置中 <code>String projectPath = System.getProperty(&quot;user.dir&quot;);</code> 获取<strong>Working Directory</strong>时 返回的是项目路径，并非模块路径！</p>
<h6 id="解决方法："><a href="#解决方法：" class="headerlink" title="解决方法："></a>解决方法：</h6><p>​    我们可以设定运行参数选项</p>
<p><img src="/2019/04/04/MyBatis-Plus我来填坑/1546927538730.png" alt="1546927538730"></p>
<p>将 <strong>Working Directory</strong> 调整为 <strong><u>当前模块目录</u></strong> 再次运行就ok了！</p>
<ul>
<li>因为没有引入mvc 模块 以至于@Controller 会飘红  再Demo中就没有将生成代码传入  大可拉取代码本地使用！</li>
<li>相关代码生成器的配置：<span class="exturl" data-url="aHR0cHM6Ly9teWJhdGlzLnBsdXMvY29uZmlnL2dlbmVyYXRvci1jb25maWcuaHRtbA==" title="https://mybatis.plus/config/generator-config.html">官方生成器配置<i class="fa fa-external-link"></i></span> 可配置项过多无法详细介绍 有相关使用会提及</li>
</ul>
<h3 id="核心二-清晰之-CRUD接口"><a href="#核心二-清晰之-CRUD接口" class="headerlink" title="核心二 - 清晰之-CRUD接口"></a>核心二 - 清晰之-CRUD接口</h3><h4 id="Demo代码地址：-2"><a href="#Demo代码地址：-2" class="headerlink" title="Demo代码地址："></a>Demo代码地址：</h4><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3d1bmlhbjd5dWxpYW4vTXliYXRpc1BsdXNEZW1vL3RyZWUvbWFzdGVyL21wX2NydWRfZGVtbw==" title="https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/mp_crud_demo">https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/mp_crud_demo<i class="fa fa-external-link"></i></span></p>
<p>​    Mybatis-Plus 为我们提供了丰富的 增删改查接口 </p>
<p>​    我们可以分为三类 <strong>Mapper的CRUD接口</strong>、<strong>Service的CRUD接口</strong>和<strong>mapper层选装件接口</strong>：</p>
<p><img src="/2019/04/04/MyBatis-Plus我来填坑/1546932099260.png" alt="1546932099260"></p>
<p>​    确实比较丰富 ， 下面会以具有代表性的例子来使用 演示 作为Demo主要内容</p>
<h4 id="工程：-2"><a href="#工程：-2" class="headerlink" title="工程："></a>工程：</h4><h5 id="第一步、创建模块-1"><a href="#第一步、创建模块-1" class="headerlink" title="第一步、创建模块"></a>第一步、创建模块</h5><p>​    创建mp_crud_demo模块 选择mysql </p>
<h5 id="第二步、引入依赖坐标-2"><a href="#第二步、引入依赖坐标-2" class="headerlink" title="第二步、引入依赖坐标"></a>第二步、引入依赖坐标</h5><p>​    因为需要生成表对应Pojo 还需要代码生成器  </p>
<p>​    然后我们将上面的直接拷贝一下 </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.7.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--手动添加模板引擎--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.freemarker<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>freemarker<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​    再添加 lombok 依赖(因：生成代码中的实体默认是使用@Data 等注解的)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="第三步、生成代码"><a href="#第三步、生成代码" class="headerlink" title="第三步、生成代码"></a>第三步、生成代码</h5><ul>
<li><strong>复制</strong>上一Demo<u>模块生成器</u><strong>代码</strong></li>
<li><strong>更改模块名</strong>称使之对应 <code>pc.setParent(&quot;com.lynwood.mp.mp_crud_demo&quot;);</code></li>
<li><strong>设置Working Directory</strong> 为<strong>当前模块</strong> 防止文件输出位置错误</li>
<li>运行<strong>获取代码</strong></li>
<li><strong>删除</strong>不必要用到的<strong>controller层</strong></li>
</ul>
<h5 id="第四步、其他配置需要"><a href="#第四步、其他配置需要" class="headerlink" title="第四步、其他配置需要"></a>第四步、其他配置需要</h5><ul>
<li><p>设定mybatis扫描位置</p>
<p>在<code>MpCrudDemoApplication</code> 上<strong>添加注解</strong>：<code>@MapperScan(&quot;com.lynwood.mp.mp_crud_demo.*.mapper**&quot;)</code></p>
<p><strong>注意 扫描包的位置</strong>！</p>
</li>
<li><p><strong>配置数据源</strong>：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DataSource Config</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  datasource:</span></span><br><span class="line">  <span class="comment"># 这里如果有错误是因为 maven mysql包 选择了 runtime 形式的 scope  可以不用管它 继续下一步就好</span></span><br><span class="line"><span class="attr">    driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">jdbc:mysql://127.0.0.1:3306/mp_demo_db?characterEncoding=utf-8</span></span><br><span class="line"><span class="attr">    username:</span> <span class="string">root</span></span><br><span class="line"><span class="attr">    password:</span> <span class="number">123456</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="第五步、对MP探个究竟！"><a href="#第五步、对MP探个究竟！" class="headerlink" title="第五步、对MP探个究竟！"></a>第五步、对MP探个究竟！</h5><p>​    <u><strong>以<code>userMapper</code>作为范例</strong></u></p>
<ul>
<li><p>查看<code>UserMapper</code>:</p>
<p>打开<code>UserMapper.java</code>源代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>不难发现它<strong>继承了</strong><code>BaseMapper&lt;User&gt;</code> 接口 </p>
<p>打开<code>com.baomidou.mybatisplus.core.mapper.BaseMapper&lt;T&gt;</code> </p>
<p>查看当前接口的结构(Structure): </p>
<p><img src="/2019/04/04/MyBatis-Plus我来填坑/1547002387987.png" alt="1547002387987"></p>
<p><strong>原来</strong>是MP 将之前的mybatis里面<strong>每个mapper的所有方法</strong> 经过<strong>泛型</strong>进行提炼到了一个BaseMapper 接口中,我们<strong>只需要将自己的mapper 继承此接口且将泛型指定便可获得强大的CRUD功能</strong>!</p>
</li>
<li><p>再去查看<code>UserMapper.xml</code> 文件 :</p>
</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC <span class="string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">"com.lynwood.mp.mp_crud_demo.business.mapper.UserMapper"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>
<p>​    <strong>完全丢弃了<code>Mybatis</code>中字段映射以及一段段复杂的配置!</strong></p>
<hr>
<h5 id="发现问题-我虽然看到了方法-但是并没有一条SQL-那么它是怎样做到查询的呢"><a href="#发现问题-我虽然看到了方法-但是并没有一条SQL-那么它是怎样做到查询的呢" class="headerlink" title="发现问题:  我虽然看到了方法 但是并没有一条SQL 那么它是怎样做到查询的呢?"></a><strong>发现问题</strong>:  我虽然看到了方法 但是并没有一条SQL 那么它是怎样做到查询的呢?</h5><h6 id="探索"><a href="#探索" class="headerlink" title="探索:"></a>探索:</h6><ul>
<li><strong><em>首先</em></strong> 在项目搭建的时候添加了 坐标:</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.7.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>我们进入<code>mybatis-plus-boot-starter</code>的pom 发现他帮我们装配了对应版本的<code>mybatis-plus</code> 并且依赖了其他 例如: <code>spring-boot-autoconfigure`</code>spring-boot-starter-jdbc`等;</p>
<p>因为<strong>了解</strong><code>SpringBoot</code>中<strong>配置入口</strong>是一个<code>@Configuration</code> </p>
<p>那么<strong>打开</strong><code>mybatis-plus-boot-starter</code>的<code>jar</code>包 <strong>看到</strong>:<code>MybatisPlusAutoConfiguration.java</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisPlusAutoConfiguration</span> </span>&#123;</span><br><span class="line"> ...</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SqlSessionFactory <span class="title">sqlSessionFactory</span><span class="params">(DataSource dataSource)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">     ...</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.applicationContext.getBeanNamesForType(ISqlInjector.class, <span class="keyword">false</span>, <span class="keyword">false</span>).length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            ISqlInjector iSqlInjector = (ISqlInjector)<span class="keyword">this</span>.applicationContext.getBean(ISqlInjector.class);</span><br><span class="line">            globalConfig.setSqlInjector(iSqlInjector);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        factory.setGlobalConfig(globalConfig);</span><br><span class="line">        <span class="keyword">return</span> factory.getObject();</span><br><span class="line"> &#125;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看到它在设置<code>sqlSessionFactory</code>的时候为我们<strong>指定</strong>了一个<code>com.baomidou.mybatisplus.core.injector.ISqlInjector.class</code> <strong>作为</strong><code>factory.globalConfig.sqlInjector</code>(<strong>SQL注入器</strong>)</p>
<p> <strong><em>然后</em></strong> 我们打开:<code>ISqlInjector</code>的实现类<code>AbstractSqlInjector</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractSqlInjector</span> <span class="keyword">implements</span> <span class="title">ISqlInjector</span> </span>&#123;</span><br><span class="line">        ...</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">inspectInject</span><span class="params">(MapperBuilderAssistant builderAssistant, Class&lt;?&gt; mapperClass)</span> </span>&#123;</span><br><span class="line">            ...</span><br><span class="line">            List&lt;AbstractMethod&gt; methodList = <span class="keyword">this</span>.getMethodList();</span><br><span class="line">            Assert.notEmpty(methodList, <span class="string">"No effective injection method was found."</span>, <span class="keyword">new</span> Object[<span class="number">0</span>]);</span><br><span class="line">       </span><br><span class="line">            methodList.forEach((m) -&gt; &#123;</span><br><span class="line">                m.inject(builderAssistant, mapperClass);</span><br><span class="line">            &#125;);</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><code>methodList</code> 是所有的方法的一个集合 其<strong>元素类型</strong>都是<code>AbstractMethod.class</code>类型的, 并且对<strong>每个方法都进行了</strong><code>inject(...)</code>,</p>
<p>那么查看<code>inject()</code>方法源码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">inject</span><span class="params">(MapperBuilderAssistant builderAssistant, Class&lt;?&gt; mapperClass)</span> </span>&#123;</span><br><span class="line">   ...</span><br><span class="line">        <span class="keyword">this</span>.injectMappedStatement(mapperClass, modelClass, tableInfo);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>原来最终调用</strong>了<code>injectMappedStatement()</code>方法   </p>
<p><strong>然而</strong> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> MappedStatement <span class="title">injectMappedStatement</span><span class="params">(Class&lt;?&gt; var1, Class&lt;?&gt; var2, TableInfo var3)</span></span>;</span><br></pre></td></tr></table></figure>
<p>是<strong>抽象的</strong> 需要自己的子类<strong>去实现</strong>的  </p>
<p><img src="/2019/04/04/MyBatis-Plus我来填坑/1547011199397.png" alt="1547011199397"></p>
<p>我们<strong>以</strong>其中一个 <code>SelectById.class</code>  作为<strong>例子</strong>查看</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> MappedStatement <span class="title">injectMappedStatement</span><span class="params">(Class&lt;?&gt; mapperClass, Class&lt;?&gt; modelClass, TableInfo tableInfo)</span> </span>&#123;</span><br><span class="line">      SqlMethod sqlMethod = SqlMethod.SELECT_BY_ID;</span><br><span class="line">      SqlSource sqlSource = <span class="keyword">new</span> RawSqlSource(<span class="keyword">this</span>.configuration, String.format(sqlMethod.getSql(), <span class="keyword">this</span>.sqlSelectColumns(tableInfo, <span class="keyword">false</span>), tableInfo.getTableName(), tableInfo.getKeyColumn(), tableInfo.getKeyProperty()), Object.class);</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.addSelectMappedStatement(mapperClass, sqlMethod.getMethod(), sqlSource, modelClass, tableInfo);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p><strong>再去查看</strong> <code>SqlMethod.SELECT_BY_ID;</code>: </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT_BY_ID(<span class="string">"selectById"</span>, <span class="string">"根据ID 查询一条数据"</span>, <span class="string">"SELECT %s FROM %s WHERE %s=#&#123; %s&#125;"</span>),</span><br></pre></td></tr></table></figure>
<p><em>soga~</em></p>
<p><strong><em>结束</em></strong> 最后实际上 MP将SQL语句 封装了<strong>固定的模板</strong> <code>com.baomidou.mybatisplus.core.enums.SqlMethod</code> 从而提供给了我们便捷的使用!</p>
<h5 id="第六步、使用它"><a href="#第六步、使用它" class="headerlink" title="第六步、使用它"></a>第六步、使用它</h5><p>​    我们使用<strong>非Wrapper</strong>的具有代表性的接口作为Demo的演示</p>
<p>​    Wrapper 在后面会有单独的Demo演示</p>
<h6 id="Mapper-简单的CRUD"><a href="#Mapper-简单的CRUD" class="headerlink" title="Mapper - 简单的CRUD:"></a>Mapper - 简单的CRUD:</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MpCrudDemoApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">simplenessMapperCURD</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//增加</span></span><br><span class="line">        User addUser = <span class="keyword">new</span> User();</span><br><span class="line">        addUser.setAge(<span class="number">18</span>);</span><br><span class="line">        addUser.setEmail(<span class="string">"wunian_@hotmail.com"</span>);</span><br><span class="line">        addUser.setName(<span class="string">"Lynwood"</span>);</span><br><span class="line">        userMapper.insert(addUser); <span class="comment">// insert 之后是将id装配到实体对象里的</span></span><br><span class="line">        System.out.println(<span class="string">"add:\n"</span> + addUser);</span><br><span class="line">        <span class="comment">// User(id=1082883152404103169, name=Lynwood, age=18, email=wunian_@hotmail.com)</span></span><br><span class="line">        <span class="comment">// id = 1082883152404103169  之所以这么长是因为  MP底层给我们自己以uuid 的形式添加了 user对象的id属性</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//修改</span></span><br><span class="line">        User updateUser = <span class="keyword">new</span> User();</span><br><span class="line">        updateUser.setId(<span class="number">1082883152404103169L</span>);</span><br><span class="line">        updateUser.setName(<span class="string">"ok?"</span>);</span><br><span class="line">        userMapper.updateById(updateUser);</span><br><span class="line">        System.out.println(<span class="string">"update:\n"</span> + updateUser);</span><br><span class="line">        <span class="comment">//  User(id=1082883152404103169, name=ok?, age=null, email=null)</span></span><br><span class="line">        <span class="comment">// 刷新数据库 更改成功 但是没有讲其他对象进行装配</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//查询</span></span><br><span class="line">        User selectUser = userMapper.selectById(<span class="number">1082883152404103169L</span>);</span><br><span class="line">        System.out.println(<span class="string">"select:\n"</span> + selectUser);</span><br><span class="line">        <span class="comment">//User(id=1082883152404103169, name=ok?, age=18, email=wunian_@hotmail.com)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//删除</span></span><br><span class="line">        <span class="keyword">int</span> i = userMapper.deleteById(<span class="number">1082883152404103169L</span>);</span><br><span class="line">        <span class="keyword">if</span> (i==<span class="number">1</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">"delete:\n"</span> + <span class="string">"删除成功!"</span>);</span><br><span class="line">            <span class="comment">//刷新库 删除成功</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="发现问题-虽然MP替我生成了-uuid-作为主键-但是还是想用数据库自增形式主键怎么办"><a href="#发现问题-虽然MP替我生成了-uuid-作为主键-但是还是想用数据库自增形式主键怎么办" class="headerlink" title="发现问题: 虽然MP替我生成了 uuid 作为主键,但是还是想用数据库自增形式主键怎么办?"></a><strong>发现问题</strong>: 虽然MP替我生成了 uuid 作为主键,但是还是想用数据库自增形式主键怎么办?</h5><h6 id="解决"><a href="#解决" class="headerlink" title="解决:"></a>解决:</h6><p>MP提供的主键策略有:</p>
<ul>
<li>AUTO 数据库ID自增</li>
<li>INPUT 用户输入ID</li>
<li>ID_WORKER 全局唯一ID，Long类型的主键</li>
<li>ID_WORKER_STR 字符串全局唯一ID</li>
<li>UUID 全局唯一ID，UUID类型的主键</li>
<li>NONE 该类型为未设置主键类型</li>
</ul>
<p>MP的主键策略<strong>默认</strong>使用的是<code>ID_WORKER</code> (详情:<span class="exturl" data-url="aHR0cHM6Ly9teWJhdGlzLnBsdXMvY29uZmlnLyNpZHR5cGU=" title="https://mybatis.plus/config/#idtype">https://mybatis.plus/config/#idtype<i class="fa fa-external-link"></i></span>)</p>
<p>在User 中<strong>设定 id字段</strong>为<code>@TableId(type = IdType.AUTO)</code> </p>
<p>或者 <strong>全局设置 使用主键策略</strong>,在yaml 添加:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line"><span class="attr">  global-config:</span></span><br><span class="line"><span class="attr">    db-config:</span></span><br><span class="line"><span class="attr">      id-type:</span> <span class="string">auto</span></span><br></pre></td></tr></table></figure>
<p><strong>重要</strong>:  <strong>因为刚才的测试插入了id为:<code>1082883152404103169</code>的 数据 我们需要将自增序列首先恢复正常! 否则下一个id为1082883152404103170 看上去也是乱的!!  小心坑哈~  </strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> auto_increment= <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<p>尝试 增加操作  输出: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">add:</span><br><span class="line">User(id=1, name=Lynwood, age=18, email=wunian_@hotmail.com)</span><br></pre></td></tr></table></figure>
<h6 id="Mapper-批量的CRUD接口"><a href="#Mapper-批量的CRUD接口" class="headerlink" title="Mapper - 批量的CRUD接口:"></a>Mapper - 批量的CRUD接口:</h6><p>​    填充测试数据: </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="keyword">user</span>;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">user</span> ( <span class="keyword">name</span>, age, email) <span class="keyword">VALUES</span></span><br><span class="line">( <span class="string">'Lynwood'</span>,<span class="number">18</span>,<span class="string">'wunian_@hotmail.com'</span>)</span><br><span class="line">( <span class="string">'Jone'</span>, <span class="number">18</span>, <span class="string">'test1@baomidou.com'</span>),</span><br><span class="line">( <span class="string">'Jack'</span>, <span class="number">20</span>, <span class="string">'test2@baomidou.com'</span>),</span><br><span class="line">( <span class="string">'Tom'</span>, <span class="number">28</span>, <span class="string">'test3@baomidou.com'</span>),</span><br><span class="line">( <span class="string">'Sandy'</span>, <span class="number">21</span>, <span class="string">'test4@baomidou.com'</span>),</span><br><span class="line">( <span class="string">'Billie'</span>, <span class="number">24</span>, <span class="string">'test5@baomidou.com'</span>);</span><br></pre></td></tr></table></figure>
<p>测试:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">batchMapperCURD</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="comment">// 多id 查询</span></span><br><span class="line">       List&lt;Long&gt; idList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">       idList.add(<span class="number">1L</span>);</span><br><span class="line">       idList.add(<span class="number">3L</span>);</span><br><span class="line">       List&lt;User&gt; userList = userMapper.selectBatchIds(idList);<span class="comment">// id的多个查询</span></span><br><span class="line">       System.out.println(<span class="string">"selectBatch:"</span> );</span><br><span class="line">       userList.forEach(System.out::println);</span><br><span class="line">       <span class="comment">//User(id=1, name=Lynwood, age=18, email=wunian_@hotmail.com)</span></span><br><span class="line">       <span class="comment">//User(id=3, name=Jack, age=20, email=test2@baomidou.com)</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">// 多条件  查询</span></span><br><span class="line">       Map&lt;String,Object&gt; stringObjectMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">       stringObjectMap.put(<span class="string">"age"</span>,<span class="number">18</span>);</span><br><span class="line">       stringObjectMap.put(<span class="string">"id"</span>,<span class="number">2</span>);</span><br><span class="line">       List&lt;User&gt; selectByMap = userMapper.selectByMap(stringObjectMap);<span class="comment">// 字段-值 键值对集合 作为 '且' 关系</span></span><br><span class="line">       System.out.println(<span class="string">"selectByMap:"</span> );</span><br><span class="line">       selectByMap.forEach(System.out::println);</span><br><span class="line">       <span class="comment">//User(id=2, name=Jone, age=18, email=test1@baomidou.com)</span></span><br><span class="line">       </span><br><span class="line">       <span class="comment">// 多id 删除</span></span><br><span class="line">       <span class="keyword">int</span> deleteCount = userMapper.deleteBatchIds(idList);<span class="comment">// id的多个删除</span></span><br><span class="line">       System.out.println(<span class="string">"deleteBatch:\n"</span>+ deleteCount );</span><br><span class="line">       <span class="comment">// 2</span></span><br><span class="line">       </span><br><span class="line">       <span class="comment">// 多条件 删除</span></span><br><span class="line">       <span class="keyword">int</span> deleteCount2 = userMapper.deleteByMap(stringObjectMap);<span class="comment">// id的多个查询</span></span><br><span class="line">       System.out.println(<span class="string">"deleteByMap:\n"</span>+ deleteCount2 );</span><br><span class="line">       <span class="comment">// 1</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>​    注意使用<code>*ByMap()</code> 方法时 条件是 <strong>且关系</strong>就ok了!</p>
<h6 id="Mapper-选装组件"><a href="#Mapper-选装组件" class="headerlink" title="Mapper - 选装组件:"></a>Mapper - 选装组件:</h6><p>查看了MP作者说的: </p>
<p><img src="/2019/04/04/MyBatis-Plus我来填坑/1547021955044.png" alt="1547021955044"></p>
<p>中的 <strong><span class="exturl" data-url="aHR0cHM6Ly9naXRlZS5jb20vYmFvbWlkb3UvbXliYXRpcy1wbHVzLXNhbXBsZXMvdHJlZS9tYXN0ZXIvbXliYXRpcy1wbHVzLXNhbXBsZS1zcWwtaW5qZWN0b3I=" title="https://gitee.com/baomidou/mybatis-plus-samples/tree/master/mybatis-plus-sample-sql-injector">案例<i class="fa fa-external-link"></i></span></strong> 以及 <strong><span class="exturl" data-url="aHR0cHM6Ly9naXRlZS5jb20vYmFvbWlkb3UvbXliYXRpcy1wbHVzL2Jsb2IvMy4wL215YmF0aXMtcGx1cy1leHRlbnNpb24vc3JjL21haW4vamF2YS9jb20vYmFvbWlkb3UvbXliYXRpc3BsdXMvZXh0ZW5zaW9uL2luamVjdG9yL21ldGhvZHMvYWRkaXRpb25hbC9JbnNlcnRCYXRjaFNvbWVDb2x1bW4uamF2YQ==" title="https://gitee.com/baomidou/mybatis-plus/blob/3.0/mybatis-plus-extension/src/main/java/com/baomidou/mybatisplus/extension/injector/methods/additional/InsertBatchSomeColumn.java">源码注释<i class="fa fa-external-link"></i></span></strong> 之后</p>
<p>作者在源码注释中是这么写的….:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt; 批量新增数据,自选字段 insert &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt; 不同的数据库支持度不一样!!!  只在 mysql 下测试过!!!  只在 mysql 下测试过!!!  只在 mysql 下测试过!!! &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt; 除了主键是 &lt;strong&gt; 数据库自增的未测试 &lt;/strong&gt; 外理论上都可以使用!!! &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt; 如果你使用自增有报错或主键值无法回写到entity,就不要跑来问为什么了,因为我也不知道!!! &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 自己的通用 mapper 如下使用:</span></span><br><span class="line"><span class="comment"> * int insertBatchSomeColumn(List&lt;T&gt; entityList);</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;li&gt; 注意1: 不要加任何注解 !! &lt;/li&gt;</span></span><br><span class="line"><span class="comment"> * &lt;li&gt; 注意2: 自选字段 insert !!,如果个别字段在 entity 里为 null 但是数据库中有配置默认值, insert 后数据库字段是为 null 而不是默认值 &lt;/li&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 常用的构造入参:</span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
<p>┓( ´∀` )┏  ~</p>
<p> 然后分析其作用  觉得既然有wrapper的强大条件构造器 决定不再分析  想了解可以点击:</p>
<p><strong><span class="exturl" data-url="aHR0cHM6Ly9naXRlZS5jb20vYmFvbWlkb3UvbXliYXRpcy1wbHVzL2Jsb2IvMy4wL215YmF0aXMtcGx1cy1leHRlbnNpb24vc3JjL21haW4vamF2YS9jb20vYmFvbWlkb3UvbXliYXRpc3BsdXMvZXh0ZW5zaW9uL2luamVjdG9yL21ldGhvZHMvYWRkaXRpb25hbC9JbnNlcnRCYXRjaFNvbWVDb2x1bW4uamF2YQ==" title="https://gitee.com/baomidou/mybatis-plus/blob/3.0/mybatis-plus-extension/src/main/java/com/baomidou/mybatisplus/extension/injector/methods/additional/InsertBatchSomeColumn.java">源码注释<i class="fa fa-external-link"></i></span></strong></p>
<p>不过 <strong>案例</strong>  说明了MP的一些可以自己扩展的一个流程 :</p>
<ol>
<li><p>第一步: 在<code>UserMapper</code>添加方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 清空表数据 */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">clearTable</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>第二步:自定义实现</p>
<p>在于<code>business</code>同级下创建<code>mp_injector/methods</code>目录并创建<strong>类名</strong><code>CLearTable.java</code> <strong>要与</strong>添加的<strong>方法名</strong> <strong>相同!</strong> </p>
<p>且要实现<code>com.baomidou.mybatisplus.core.injector.AbstractMethod</code> 完成自定义扩展</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClearTable</span> <span class="keyword">extends</span> <span class="title">AbstractMethod</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MappedStatement <span class="title">injectMappedStatement</span><span class="params">(Class&lt;?&gt; mapperClass, Class&lt;?&gt; modelClass, TableInfo tableInfo)</span> </span>&#123;</span><br><span class="line">        <span class="comment">/* 执行 SQL */</span></span><br><span class="line">        String sql = <span class="string">"delete from "</span> + tableInfo.getTableName();</span><br><span class="line">        <span class="comment">/* mapper 接口方法名一致 */</span></span><br><span class="line">        String method = <span class="string">"clearTable"</span>;</span><br><span class="line">        SqlSource sqlSource = languageDriver.createSqlSource(configuration, sql, modelClass);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.addDeleteMappedStatement(mapperClass, method, sqlSource);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>第三步:将自定义实现 添加到MP方法列表</p>
<p>在<code>mp_injector</code>下创建<code>MySqlInjector.java</code> 来进行对MP的<strong>扩展操作:</strong></p>
<p>需要继承<code>com.baomidou.mybatisplus.core.injector.DefaultSqlInjector</code> 并且重写 MP获取方法列表的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MySqlInjector</span> <span class="keyword">extends</span> <span class="title">DefaultSqlInjector</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;AbstractMethod&gt; <span class="title">getMethodList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;AbstractMethod&gt; methodList = <span class="keyword">super</span>.getMethodList();</span><br><span class="line">        <span class="comment">//增加了 自定义方法</span></span><br><span class="line">        methodList.add(<span class="keyword">new</span> ClearTable());</span><br><span class="line">        <span class="keyword">return</span> methodList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>第四步:测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myInjectorMapperCURD</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    userMapper.clearTable();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>查库 全部删除了</p>
</li>
<li><p>总结: </p>
<p>不难发现其实际上就是 在上文 <a href="#第五步对mp探个究竟"> 对MP探个究竟</a> 中探索到的 所有方法的原理</p>
</li>
</ol>
<h6 id="Service-CRUD"><a href="#Service-CRUD" class="headerlink" title="Service - CRUD:"></a>Service - CRUD:</h6><p>​    非Wrapper部分基本与Mapper 接口一致   只是将接口提到了service层.</p>
<p>​    略~</p>
<h3 id="核心三-强大之-Wrapper条件构造器"><a href="#核心三-强大之-Wrapper条件构造器" class="headerlink" title="核心三 - 强大之 -Wrapper条件构造器"></a>核心三 - 强大之 -Wrapper条件构造器</h3><h4 id="Demo代码地址：-3"><a href="#Demo代码地址：-3" class="headerlink" title="Demo代码地址："></a>Demo代码地址：</h4><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3d1bmlhbjd5dWxpYW4vTXliYXRpc1BsdXNEZW1vL3RyZWUvbWFzdGVyL21wX3dyYXBwZXJfZGVtbw==" title="https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/mp_wrapper_demo">https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/mp_wrapper_demo<i class="fa fa-external-link"></i></span></p>
<h4 id="工程"><a href="#工程" class="headerlink" title="工程:"></a>工程:</h4><h5 id="第一-–-gt-第四步-同上一工程步骤"><a href="#第一-–-gt-第四步-同上一工程步骤" class="headerlink" title="第一 –&gt;第四步 同上一工程步骤"></a>第一 –&gt;第四步 同上一工程步骤</h5><ul>
<li>注意更改生成器中的 包名模块名</li>
<li>复制yaml 时注意增加 MP主键策略配置: </li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line"><span class="attr">  global-config:</span></span><br><span class="line"><span class="attr">    db-config:</span></span><br><span class="line"><span class="attr">      id-type:</span> <span class="string">auto</span></span><br></pre></td></tr></table></figure>
<h5 id="第五步、探索Wrapper"><a href="#第五步、探索Wrapper" class="headerlink" title="第五步、探索Wrapper"></a>第五步、探索Wrapper</h5><p>​    备:关于 <strong>java8 lambda 表达式</strong> 默认为熟悉</p>
<h6 id="Wrapper含义"><a href="#Wrapper含义" class="headerlink" title="Wrapper含义:"></a>Wrapper含义:</h6><p>​    <img src="/2019/04/04/MyBatis-Plus我来填坑/1547101878214.png" alt="1547101878214"></p>
<h6 id="版本不同"><a href="#版本不同" class="headerlink" title="版本不同:"></a>版本不同:</h6><p>因为MP 对外已经有了两个大的版本  2.x 和3.x版本</p>
<p>在2.x版本中 <code>EntityWrapper</code>作为Wrapper 的主要继承实现,</p>
<p>例:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">EntityWrapper&lt;User&gt; ew = <span class="keyword">new</span> EntityWrapper&lt;User&gt;();</span><br><span class="line">   ew.setEntity(<span class="keyword">new</span> User(<span class="number">1</span>));</span><br><span class="line">   ew.where(<span class="string">"user_name=&#123;0&#125;"</span>, <span class="string">"'zhangsan'"</span>).and(<span class="string">"id=1"</span>)</span><br><span class="line">           .orNew(<span class="string">"user_status=&#123;0&#125;"</span>, <span class="string">"0"</span>).or(<span class="string">"status=1"</span>)</span><br><span class="line">           .notLike(<span class="string">"user_nickname"</span>, <span class="string">"notvalue"</span>)</span><br><span class="line">           .andNew(<span class="string">"new=xx"</span>).like(<span class="string">"hhh"</span>, <span class="string">"ddd"</span>)</span><br><span class="line">           .andNew(<span class="string">"pwd=11"</span>).isNotNull(<span class="string">"n1,n2"</span>).isNull(<span class="string">"n3"</span>)</span><br><span class="line">           .groupBy(<span class="string">"x1"</span>).groupBy(<span class="string">"x2,x3"</span>)</span><br><span class="line">           .having(<span class="string">"x1=11"</span>).having(<span class="string">"x3=433"</span>)</span><br><span class="line">           .orderBy(<span class="string">"dd"</span>).orderBy(<span class="string">"d1,d2"</span>);</span><br><span class="line">   System.out.println(ew.getSqlSegment());</span><br></pre></td></tr></table></figure>
<p>实际上 此包装实际上是<strong>使用的是 数据库字段</strong> 不是Pojo 里面的成员变量</p>
<p><strong>在3.x 升级中对Wrapper进行了改动</strong>:</p>
<ul>
<li><p>全面支持了jdk8的<strong>Lambda</strong>的使用</p>
</li>
<li><p><code>Wrapper&lt;T&gt;</code>实现类的改动</p>
<p>1.<code>EntityWrapper&lt;T&gt;</code>更名为<code>QueryWrapper&lt;T&gt;</code><br>2.新增一个实现类<code>UpdateWrapper&lt;T&gt;</code>用于<code>update</code>方法</p>
</li>
<li><p><code>BaseMapper&lt;T&gt;</code>的改动</p>
<p>1.去除了<code>insertAllColumn(T entity)</code>方法<br>2.去除了<code>updateAllColumn(T entity)</code>方法<br>3.新增<code>update(T entity, Wrapper&lt;T&gt; updateWrapper)</code>方法</p>
</li>
</ul>
<p>在3.x 中将 所有的操作划分成 查询<code>QueryWrapper</code>和<code>UpdateWrapper</code> 并且将其共有的方法做了一层<strong>抽离</strong>放<strong>到</strong>了<code>AbstractWrapper</code><strong>中</strong></p>
<h6 id="3-x-Wrapper主要继承结构"><a href="#3-x-Wrapper主要继承结构" class="headerlink" title="3.x Wrapper主要继承结构:"></a>3.x Wrapper主要继承结构:</h6><p><img src="/2019/04/04/MyBatis-Plus我来填坑/1547103652530.png" alt="1547103652530"></p>
<p>我们查看<strong>四个实现类</strong>:<code>QueryWrapper</code>、<code>UpdateWrapper</code> 、<code>LambdaQueryWrapper</code>、<code>LambdaUpdateWrapper</code> 的一个<strong>总体抽象</strong>: <code>AbstractWrapper</code></p>
<p>它将共有的提升到这一层并做了实现,</p>
<p>​    <strong>其实主要是对SQL语言所有DML语句中公用的一些关键字做了统一的接口</strong></p>
<h6 id="AbstractWrapper接口"><a href="#AbstractWrapper接口" class="headerlink" title="AbstractWrapper接口:"></a>AbstractWrapper接口:</h6><p><img src="/2019/04/04/MyBatis-Plus我来填坑/1547104354429.png" alt="1547104354429"></p>
<h6 id="AbstractWrapper接口-1"><a href="#AbstractWrapper接口-1" class="headerlink" title="AbstractWrapper接口:"></a>AbstractWrapper接口:</h6><p><img src="/2019/04/04/MyBatis-Plus我来填坑/1547104548508.png" alt="1547104548508"></p>
<h6 id="UpdateWrapper接口"><a href="#UpdateWrapper接口" class="headerlink" title="UpdateWrapper接口:"></a>UpdateWrapper接口:</h6><p><img src="/2019/04/04/MyBatis-Plus我来填坑/1547104637008.png" alt="1547104637008"></p>
<h5 id="第六步、使用接口"><a href="#第六步、使用接口" class="headerlink" title="第六步、使用接口"></a>第六步、使用接口</h5><h6 id="打印SQL日志配置"><a href="#打印SQL日志配置" class="headerlink" title="##打印SQL日志配置"></a><strong>##打印SQL日志配置</strong></h6><p>为了方便查看最后MP封装转换的最终SQL，在yml配置文件中添加配置:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line"><span class="attr">  configuration:</span></span><br><span class="line"><span class="attr">    log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure>
<h6 id="一-gt-编写AbstractWrapper测试类"><a href="#一-gt-编写AbstractWrapper测试类" class="headerlink" title="一&gt; 编写AbstractWrapper测试类:"></a>一&gt; 编写AbstractWrapper测试类:</h6><p>Demo 中有  链接:<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3d1bmlhbjd5dWxpYW4vTXliYXRpc1BsdXNEZW1vL2Jsb2IvbWFzdGVyL21wX3dyYXBwZXJfZGVtby9zcmMvdGVzdC9qYXZhL2NvbS9seW53b29kL21wL21wX3dyYXBwZXJfZGVtby9NcFdyYXBwZXJEZW1vQXBwbGljYXRpb25BYnN0cmFjdFdyYXBwZXJUZXN0cy5qYXZh" title="https://github.com/wunian7yulian/MybatisPlusDemo/blob/master/mp_wrapper_demo/src/test/java/com/lynwood/mp/mp_wrapper_demo/MpWrapperDemoApplicationAbstractWrapperTests.java">https://github.com/wunian7yulian/MybatisPlusDemo/blob/master/mp_wrapper_demo/src/test/java/com/lynwood/mp/mp_wrapper_demo/MpWrapperDemoApplicationAbstractWrapperTests.java<i class="fa fa-external-link"></i></span></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MpWrapperDemoApplicationAbstractWrapperTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  测试 allEq()  等同于 WHERE name = ? AND age = ?</span></span><br><span class="line"><span class="comment">     *  +</span></span><br><span class="line"><span class="comment">     *  使用 selectList() 返回多个指定类型对象 的集合</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_allEq</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        HashMap&lt;String,Object&gt; param = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        param.put(<span class="string">"name"</span>,<span class="string">"Lynwood"</span>);</span><br><span class="line">        param.put(<span class="string">"age"</span>,<span class="string">"18"</span>);</span><br><span class="line">        userQueryWrapper.allEq(param);</span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);</span><br><span class="line">        userList.forEach(System.out::println);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 输出:</span></span><br><span class="line"><span class="comment">         *    ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE name = ? AND age = ?</span></span><br><span class="line"><span class="comment">         *    ==&gt; Parameters: Lynwood(String), 18(String)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  测试 eq()  等同于 WHERE name = ?</span></span><br><span class="line"><span class="comment">     *  +</span></span><br><span class="line"><span class="comment">     *  使用selectOne()</span></span><br><span class="line"><span class="comment">     *      当返回多条会报错</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_eq</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        userQueryWrapper.eq(<span class="string">"name"</span>,<span class="string">"Lynwood"</span>);</span><br><span class="line">        User user = userMapper.selectOne(userQueryWrapper);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 输出:</span></span><br><span class="line"><span class="comment">         *           Preparing: SELECT id,name,age,email FROM user WHERE name = ?</span></span><br><span class="line"><span class="comment">         *           Parameters: Lynwood(String)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**     not equals 缩写 ~~</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  测试 ne()  等同于 WHERE age &lt;&gt; ?</span></span><br><span class="line"><span class="comment">     *  +</span></span><br><span class="line"><span class="comment">     *  使用 selectObjs() 返回多个 非指定类型对象 的集合</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_ne</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        userQueryWrapper.ne(<span class="string">"age"</span>, <span class="number">18</span>);</span><br><span class="line">        List&lt;Object&gt; objectList = userMapper.selectObjs(userQueryWrapper);</span><br><span class="line">        objectList.forEach(System.out::println);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 输出:</span></span><br><span class="line"><span class="comment">         *    ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE age &lt;&gt; ?</span></span><br><span class="line"><span class="comment">         *      ==&gt; Parameters: 18(Integer)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***************************************************** 多接口连用 * 默认AND 关系*******************************/</span></span><br><span class="line">    <span class="comment">/**     测试</span></span><br><span class="line"><span class="comment">     *      gt() : greater than       等同于     &gt;</span></span><br><span class="line"><span class="comment">     *      ge() : greater equals     等同于     &gt;=</span></span><br><span class="line"><span class="comment">     *      lt() : less than          等同于     &lt;</span></span><br><span class="line"><span class="comment">     *      le() : less equals        等同于     &lt;=</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  使用 selectMaps() 返回多个 指定到Map做封装 的集合</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_gt_ge_lt_le</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        userQueryWrapper.ge(<span class="string">"age"</span>, <span class="number">21</span>);</span><br><span class="line">        userQueryWrapper.le(<span class="string">"age"</span>, <span class="number">24</span>);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; mapList = userMapper.selectMaps(userQueryWrapper);</span><br><span class="line">        mapList.forEach(System.out::println);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 输出:</span></span><br><span class="line"><span class="comment">         *      ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE age &gt;= ? AND age &lt;= ?</span></span><br><span class="line"><span class="comment">         *      ==&gt; Parameters: 21(Integer), 24(Integer)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  测试</span></span><br><span class="line"><span class="comment">     *      between()       等同于 WHERE age between ? and ?</span></span><br><span class="line"><span class="comment">     *      notBetween()    等同于 WHERE age not between ? and ?</span></span><br><span class="line"><span class="comment">     *  +</span></span><br><span class="line"><span class="comment">     *  使用 selectList() 返回多个 非指定类型对象 的集合</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_between</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        userQueryWrapper</span><br><span class="line">                .between(<span class="string">"age"</span>, <span class="number">18</span>,<span class="number">24</span>)</span><br><span class="line">                .notBetween(<span class="string">"id"</span>,<span class="number">0</span>,<span class="number">11</span>);<span class="comment">// 支持链式调用</span></span><br><span class="line"></span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);</span><br><span class="line">        userList.forEach(System.out::println);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 输出:</span></span><br><span class="line"><span class="comment">                 ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE age BETWEEN ? AND ? AND id NOT BETWEEN ? AND ?</span></span><br><span class="line"><span class="comment">                 ==&gt; Parameters: 18(Integer), 24(Integer), 0(Integer), 11(Integer)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  测试</span></span><br><span class="line"><span class="comment">     *      like()              等同于 LIKE '%?%'</span></span><br><span class="line"><span class="comment">     *      notLike()           等同于 NOT LIKE '%?%'</span></span><br><span class="line"><span class="comment">     *      likeLeft()          等同于 LIKE '%?'</span></span><br><span class="line"><span class="comment">     *      likeRight()         等同于 LIKE '?%'</span></span><br><span class="line"><span class="comment">     *  +</span></span><br><span class="line"><span class="comment">     *  使用 selectCount()   返回查询到的条数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_like</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        userQueryWrapper</span><br><span class="line">                .like(<span class="string">"email"</span>, <span class="string">"test"</span>)</span><br><span class="line">                .notLike(<span class="string">"email"</span>,<span class="string">"test4"</span>)</span><br><span class="line">                .likeRight(<span class="string">"name"</span>,<span class="string">"J"</span>) <span class="comment">// J%</span></span><br><span class="line">                .likeLeft(<span class="string">"name"</span>,<span class="string">"e"</span>); <span class="comment">//%e</span></span><br><span class="line">        Integer selectCount = userMapper.selectCount(userQueryWrapper);</span><br><span class="line">        System.out.println(selectCount);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 输出:</span></span><br><span class="line"><span class="comment">                 ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE email LIKE ? AND email NOT LIKE ? AND name LIKE ? AND name LIKE ?</span></span><br><span class="line"><span class="comment">                 ==&gt; Parameters: %test%(String), %test4%(String), J%(String), %e(String)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  测试</span></span><br><span class="line"><span class="comment">     *      null()              等同于 is null</span></span><br><span class="line"><span class="comment">     *      isNotNull()         等同于 is not null</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_null</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        userQueryWrapper</span><br><span class="line">               .isNotNull(<span class="string">"name"</span>);</span><br><span class="line">        Integer selectCount = userMapper.selectCount(userQueryWrapper);</span><br><span class="line">        System.out.println(selectCount);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 输出:</span></span><br><span class="line"><span class="comment">             ==&gt;  Preparing: SELECT COUNT(1) FROM user WHERE name IS NOT NULL</span></span><br><span class="line"><span class="comment">             ==&gt; Parameters:</span></span><br><span class="line"><span class="comment">             &lt;==    Columns: COUNT(1)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  测试</span></span><br><span class="line"><span class="comment">     *      in()              等同于 IN (?,?)</span></span><br><span class="line"><span class="comment">     *      notIn()           等同于 NOT IN (?,?)</span></span><br><span class="line"><span class="comment">     *      inSql()           等同于 IN (sql)</span></span><br><span class="line"><span class="comment">     *      notInSql()        等同于 NOT IN (sql)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_in</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        List&lt;Long&gt; idLists = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        idLists.add(<span class="number">11L</span>);</span><br><span class="line">        idLists.add(<span class="number">13L</span>);</span><br><span class="line">        userQueryWrapper</span><br><span class="line">               <span class="comment">// .in("id",idLists);</span></span><br><span class="line">                .inSql(<span class="string">"id"</span>,<span class="string">"select id from user where id&lt;=15"</span>);</span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);</span><br><span class="line">        userList.forEach(System.out::println);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 输出:</span></span><br><span class="line"><span class="comment">                 ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE id IN (select id from user where id&lt;=15)</span></span><br><span class="line"><span class="comment">                 ==&gt; Parameters:</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  测试</span></span><br><span class="line"><span class="comment">     *      groupBy() .. 支持多参数    等同于 GROUP BY age,name,id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_group</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        userQueryWrapper</span><br><span class="line">                .groupBy(<span class="string">"age"</span>,<span class="string">"name"</span>,<span class="string">"id"</span>);</span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);</span><br><span class="line">        userList.forEach(System.out::println);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 输出:</span></span><br><span class="line"><span class="comment">             ==&gt;  Preparing: SELECT id,name,age,email FROM user GROUP BY age,name,id</span></span><br><span class="line"><span class="comment">             ==&gt; Parameters:</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  测试</span></span><br><span class="line"><span class="comment">     *      orderBy()     .. 支持多参数    等同于 关于 condition</span></span><br><span class="line"><span class="comment">     *      orderByDesc() .. 支持多参数    等同于 ORDER BY age DESC , id DESC</span></span><br><span class="line"><span class="comment">     *      orderByAsc()  .. 支持多参数    等同于 ORDER BY age ASC , id ASC</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_order</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        userQueryWrapper</span><br><span class="line">                .orderByAsc(<span class="string">"age"</span>,<span class="string">"id"</span>);</span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);</span><br><span class="line">        userList.forEach(System.out::println);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 输出:</span></span><br><span class="line"><span class="comment">             ==&gt;  Preparing: SELECT id,name,age,email FROM user ORDER BY age ASC , id ASC</span></span><br><span class="line"><span class="comment">             ==&gt; Parameters:</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  测试</span></span><br><span class="line"><span class="comment">     *      having()     .. 支持多参数    等同于 HAVING sum(id)&gt; ?</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_having</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        userQueryWrapper</span><br><span class="line">                .groupBy(<span class="string">"age"</span>)</span><br><span class="line">                .having(<span class="string">"sum(id)&gt;&#123;0&#125;"</span>,<span class="number">20</span>);<span class="comment">// 替换里面的参数</span></span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);</span><br><span class="line">        userList.forEach(System.out::println);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 输出:</span></span><br><span class="line"><span class="comment">                 ==&gt;  Preparing: SELECT id,name,age,email FROM user GROUP BY age HAVING sum(id)&gt;?</span></span><br><span class="line"><span class="comment">                 ==&gt; Parameters: 20(Integer)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  测试</span></span><br><span class="line"><span class="comment">     *      or()       等同于 or</span></span><br><span class="line"><span class="comment">     *      and()       等同于 and</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_or_and</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 简单 or 和and</span></span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        userQueryWrapper</span><br><span class="line">                .eq(<span class="string">"id"</span>,<span class="number">11</span>)</span><br><span class="line">                .or()  <span class="comment">// 默认and()</span></span><br><span class="line"><span class="comment">//                .and() // 两个不能连用</span></span><br><span class="line">                .eq(<span class="string">"id"</span>,<span class="number">13</span>);</span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);</span><br><span class="line">        userList.forEach(System.out::println);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 输出:</span></span><br><span class="line"><span class="comment">                 ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE id = ? OR id = ?</span></span><br><span class="line"><span class="comment">                 ==&gt; Parameters: 11(Integer), 13(Integer)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 嵌套的 or 和and</span></span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper1 = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        userQueryWrapper1</span><br><span class="line">                .eq(<span class="string">"id"</span>,<span class="number">14</span>)</span><br><span class="line">                .or(i -&gt; i.eq(<span class="string">"name"</span>, <span class="string">"Lynwood"</span>).ne(<span class="string">"age"</span>, <span class="string">"18"</span>));</span><br><span class="line">        List&lt;User&gt; userList1 = userMapper.selectList(userQueryWrapper1);</span><br><span class="line">        userList1.forEach(System.out::println);</span><br><span class="line">        <span class="comment">/**输出:</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE id = ? OR ( name = ? AND age &lt;&gt; ? )</span></span><br><span class="line"><span class="comment">         * ==&gt; Parameters: 14(Integer), Lynwood(String), 18(String)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">/**!!!!!!!!!!!!  .or(i -&gt; i.eq("name", "Lynwood").ne("age", "18"));  解释  见下文发现问题*/</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  测试</span></span><br><span class="line"><span class="comment">     *      apply()    动态传参防止 sql注入    占位符 替换 以值的形式添加</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_apply</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        userQueryWrapper</span><br><span class="line">               .apply(<span class="string">"id&gt;&#123;0&#125;"</span>,<span class="number">13</span>);</span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);</span><br><span class="line">        userList.forEach(System.out::println);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 输出:</span></span><br><span class="line"><span class="comment">                 ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE id&gt;?</span></span><br><span class="line"><span class="comment">                 ==&gt; Parameters: 13(Integer)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  测试</span></span><br><span class="line"><span class="comment">     *      last()   在sql 最后追加</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *      最常用 last("limit 1")</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_last</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        userQueryWrapper</span><br><span class="line">               .last(<span class="string">"limit 2"</span>);</span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);</span><br><span class="line">        userList.forEach(System.out::println);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 输出:</span></span><br><span class="line"><span class="comment">                 ==&gt;  Preparing: SELECT id,name,age,email FROM user limit 2</span></span><br><span class="line"><span class="comment">                 ==&gt; Parameters:</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  测试</span></span><br><span class="line"><span class="comment">     *      exists()  拼接 EXISTS ( sql语句 )</span></span><br><span class="line"><span class="comment">     *      notExists()  拼接 NOT EXISTS ( sql语句 )</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_exists</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        userQueryWrapper</span><br><span class="line">                .exists(<span class="string">"SELECT id,name,age,email FROM user where id= 222"</span>);</span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);</span><br><span class="line">        userList.forEach(System.out::println);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 输出:</span></span><br><span class="line"><span class="comment">                 ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE EXISTS (SELECT id,name,age,email FROM user where id= 222)</span></span><br><span class="line"><span class="comment">                 ==&gt; Parameters:</span></span><br><span class="line"><span class="comment">                 &lt;==      Total: 0</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  测试</span></span><br><span class="line"><span class="comment">     *      nested()  正常嵌套  (无 or and 模式嵌套)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_nested</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        userQueryWrapper</span><br><span class="line">                .nested(i -&gt; i.eq(<span class="string">"name"</span>, <span class="string">"Lynwood"</span>).eq(<span class="string">"age"</span>, <span class="string">"18"</span>));</span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);</span><br><span class="line">        userList.forEach(System.out::println);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 输出:</span></span><br><span class="line"><span class="comment">                 ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE ( name = ? AND age = ? )</span></span><br><span class="line"><span class="comment">                 ==&gt; Parameters: Lynwood(String), 18(String)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="发现问题-boolean-condition-、R-column和-Function-lt-This-This-gt-func-三个参数相关问题"><a href="#发现问题-boolean-condition-、R-column和-Function-lt-This-This-gt-func-三个参数相关问题" class="headerlink" title="发现问题: boolean condition 、R column和 Function&lt;This, This&gt; func 三个参数相关问题"></a><strong>发现问题</strong>: <code>boolean condition</code> 、<code>R column</code>和 <code>Function&lt;This, This&gt; func</code> 三个参数相关问题</h5><h6 id="说明及使用"><a href="#说明及使用" class="headerlink" title="说明及使用:"></a>说明及使用:</h6><p>​    Demo 中有  测试链接:<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3d1bmlhbjd5dWxpYW4vTXliYXRpc1BsdXNEZW1vL2Jsb2IvbWFzdGVyL21wX3dyYXBwZXJfZGVtby9zcmMvdGVzdC9qYXZhL2NvbS9seW53b29kL21wL21wX3dyYXBwZXJfZGVtby9NcFdyYXBwZXJEZW1vQXBwbGljYXRpb25BYnN0cmFjdFdyYXBwZXJQYXJhbVRlc3RzLmphdmE=" title="https://github.com/wunian7yulian/MybatisPlusDemo/blob/master/mp_wrapper_demo/src/test/java/com/lynwood/mp/mp_wrapper_demo/MpWrapperDemoApplicationAbstractWrapperParamTests.java">https://github.com/wunian7yulian/MybatisPlusDemo/blob/master/mp_wrapper_demo/src/test/java/com/lynwood/mp/mp_wrapper_demo/MpWrapperDemoApplicationAbstractWrapperParamTests.java<i class="fa fa-external-link"></i></span></p>
<h6 id="1-关于入参-boolean-condition"><a href="#1-关于入参-boolean-condition" class="headerlink" title="1.关于入参: boolean condition"></a>1.关于入参: <code>boolean condition</code></h6><blockquote>
<ul>
<li><strong>以下出现的第一个入参<code>boolean condition</code>表示该条件<em>是否加入最后生成的sql中</em>,默认是true</strong></li>
</ul>
</blockquote>
<p>使用<code>ne()</code> 方法举例  源码 :</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> This <span class="title">ne</span><span class="params">(<span class="keyword">boolean</span> condition, R column, Object val)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">return</span> addCondition(condition, column, NE, val);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>测试编写:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  *  测试 boolean condition</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="meta">@Test</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_Condition</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     Integer age = <span class="keyword">new</span> Random().nextInt(<span class="number">25</span>);</span><br><span class="line">     System.out.println(<span class="string">"年龄: "</span> + age);</span><br><span class="line">     QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">     <span class="keyword">boolean</span> condition = age&lt;=<span class="number">18</span>;</span><br><span class="line">     userQueryWrapper.ne(condition,<span class="string">"name"</span>,<span class="string">"Lynwood"</span>);</span><br><span class="line">     List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);</span><br><span class="line">     userList.forEach(System.out::println);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>​    生成的随机数age 小于18岁的 不要让他查到<code>name=&quot;Lynwood&quot;</code>的信息</p>
<p>再此看来<strong>等同于</strong><code>*mapper.xml</code>配置 </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">WHERE 1=1  </span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"age &lt;= 18"</span>&gt;</span></span><br><span class="line">    AND name <span class="tag">&lt;&gt;</span> #&#123;name&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>帮我们提入到了每个方法中,并且省去我们关系 是否写<code>AND</code>关键字或者 必须有 <code>WHERE 1=1</code>这些难看却又不必要的配置</p>
<h6 id="2-关于入参-R-column"><a href="#2-关于入参-R-column" class="headerlink" title="2.关于入参: R column"></a>2.关于入参: <code>R column</code></h6><blockquote>
<ul>
<li>以下方法在入参中出现的<code>R</code>为<strong>泛型,</strong>在普通wrapper中是<code>String</code>,在LambdaWrapper中是<strong>函数</strong>(例:<code>Entity::getId</code>,<code>Entity</code>为实体类,<code>getId</code>为字段<code>id</code>的<strong>getMethod</strong>)</li>
<li>以下方法入参中的<code>R column</code>均表示数据库字段,当<code>R</code>为<code>String</code>时则为数据库字段名(<strong>字段名是数据库关键字的自己用转义符包裹!</strong>)!而不是实体类数据字段名!!!</li>
</ul>
</blockquote>
<p>查看源码 发现实际上 <code>eq()、ne()...</code> 等需要传入<code>R column</code>的方法实际最后<strong>都是调用</strong>了<code>addCondition(...)</code> 方法</p>
<p><img src="/2019/04/04/MyBatis-Plus我来填坑/1547174994254.png" alt="1547174994254"></p>
<p>对 <code>R column</code>参数做了 <code>columnToString(column)</code>操作</p>
<p>而 <code>AbstractWrapper</code>实际中的<strong>此方法是抽象</strong>的: </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取 columnName</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> String <span class="title">columnToString</span><span class="params">(R column)</span></span>;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/04/04/MyBatis-Plus我来填坑/1547175323184.png" alt="1547175323184"></p>
<p>而我们再去查看我们使用的 <code>QueryWrapper</code>与<code>UpdateWrapper</code> 中的<strong>具体实现</strong>都为:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> String <span class="title">columnToString</span><span class="params">(String column)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> column;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>实际上是转换成了<code>String</code>类型, <strong>那么为什么使用了泛型呢</strong>?</p>
<p>我们再返回去查看他的<strong>另一个实现类</strong><code>AbstractLambdaWrapper</code> 中的实现:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> String <span class="title">columnToString</span><span class="params">(SFunction&lt;T, ?&gt; column)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getColumn(LambdaUtils.resolve(column));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>原来这里<strong>使用泛型</strong> 为了<strong>扩展Lambda方式</strong>使用!</p>
<blockquote>
<h3 id="lambda"><a href="#lambda" class="headerlink" title="lambda"></a>lambda</h3><ul>
<li>获取 <code>LambdaWrapper</code><br>在<code>QueryWrapper</code>中是获取<code>LambdaQueryWrapper</code><br>在<code>UpdateWrapper</code>中是获取<code>LambdaUpdateWrapper</code></li>
</ul>
</blockquote>
<p>测试:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  测试 R column</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_Column</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  		QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line"><span class="comment">//        userQueryWrapper.ne("name","Lynwood");</span></span><br><span class="line">        userQueryWrapper.lambda().eq(User::getName,<span class="string">"Lynwood"</span>);</span><br><span class="line">        </span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);</span><br><span class="line">        userList.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h6 id="3-关于入参-Function-lt-This-This-gt-func"><a href="#3-关于入参-Function-lt-This-This-gt-func" class="headerlink" title="3.关于入参: Function&lt;This, This&gt; func"></a>3.关于入参: <code>Function&lt;This, This&gt; func</code></h6><p><strong>其实再测试AbstractWrapper中的 or/and 嵌套中已经使用过了</strong></p>
<p>以<code>or()</code>举例  </p>
<p>​    需要<strong>传入的是</strong>  <code>Function</code><strong>的实现</strong>  而<code>Function</code>的定义是: </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Represents a function that accepts one argument and produces a result.</span></span><br><span class="line"><span class="comment"> *	表示接受一个参数执行生成结果的函数对象。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.8</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Function</span>&lt;<span class="title">T</span>, <span class="title">R</span>&gt; </span>&#123;</span><br></pre></td></tr></table></figure>
<p>在我们使用过程中 往往是为了<strong>嵌套</strong> 我们传入的可能是另一个Wrapper 让他和当前的Wrapper去链接/嵌套起来</p>
<p>那么在:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">userQueryWrapper.ne(<span class="string">"name"</span>,<span class="string">"Lynwood"</span>)</span><br><span class="line">                      .or(i -&gt; i.eq(<span class="string">"age"</span>, <span class="string">"18"</span>));</span><br></pre></td></tr></table></figure>
<p>中 我们实际上传入了一个匿名的Wrapper对象,那么这个<strong>匿名的Wrapper对象怎么符合了Function的要求呢</strong></p>
<p>我们查看这个<code>i</code>变量 : <img src="/2019/04/04/MyBatis-Plus我来填坑/1547179827539.png" alt="1547179827539"></p>
<p>他的类型是与调用对象一致的  查看 <code>QueryWrapper&lt;User&gt;</code>的继承关系:</p>
<p><img src="/2019/04/04/MyBatis-Plus我来填坑/1547179917168.png" alt="1547179917168"></p>
<p>实际上我们使用的所有接口都去间接继承了<code>ISqlSegment</code> 接口 ,而它:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.baomidou.mybatisplus.core.conditions;</span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ISqlSegment</span> <span class="keyword">extends</span> <span class="title">Serializable</span> </span>&#123;</span><br></pre></td></tr></table></figure>
<p>是被@FunctionalInterface 标识的  与:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.util.function;</span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Function</span>&lt;<span class="title">T</span>, <span class="title">R</span>&gt; </span>&#123;</span><br></pre></td></tr></table></figure>
<p>是一样的, 所以我们使用它可以这样简便的使用啦:</p>
<p>测试:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_Func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">       userQueryWrapper.ne(<span class="string">"name"</span>,<span class="string">"Lynwood"</span>);</span><br><span class="line">       userQueryWrapper.or(<span class="keyword">new</span> Function&lt;QueryWrapper&lt;User&gt;, QueryWrapper&lt;User&gt;&gt;() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="function"><span class="keyword">public</span> QueryWrapper&lt;User&gt; <span class="title">apply</span><span class="params">(QueryWrapper&lt;User&gt; userQueryWrapper)</span> </span>&#123;</span><br><span class="line">               <span class="keyword">return</span> userQueryWrapper.eq(<span class="string">"age"</span>, <span class="string">"18"</span>);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br><span class="line">       <span class="comment">// 等同与</span></span><br><span class="line">       <span class="comment">// userQueryWrapper.ne("name","Lynwood")</span></span><br><span class="line">       <span class="comment">//                        .or(i -&gt; i.eq("age", "18"));</span></span><br><span class="line">       List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);</span><br><span class="line">       userList.forEach(System.out::println);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<hr>
<h6 id="二-gt-编写QueryWrapper与UpdateWrapper测试类"><a href="#二-gt-编写QueryWrapper与UpdateWrapper测试类" class="headerlink" title="二&gt; 编写QueryWrapper与UpdateWrapper测试类:"></a>二&gt; 编写QueryWrapper与UpdateWrapper测试类:</h6><p>Demo 中有  链接:<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3d1bmlhbjd5dWxpYW4vTXliYXRpc1BsdXNEZW1vL2Jsb2IvbWFzdGVyL21wX3dyYXBwZXJfZGVtby9zcmMvdGVzdC9qYXZhL2NvbS9seW53b29kL21wL21wX3dyYXBwZXJfZGVtby9NcFdyYXBwZXJEZW1vQXBwbGljYXRpb25RdWVyeUFuZFVwZGF0ZVdyYXBwZXJUZXN0cy5qYXZh" title="https://github.com/wunian7yulian/MybatisPlusDemo/blob/master/mp_wrapper_demo/src/test/java/com/lynwood/mp/mp_wrapper_demo/MpWrapperDemoApplicationQueryAndUpdateWrapperTests.java">https://github.com/wunian7yulian/MybatisPlusDemo/blob/master/mp_wrapper_demo/src/test/java/com/lynwood/mp/mp_wrapper_demo/MpWrapperDemoApplicationQueryAndUpdateWrapperTests.java<i class="fa fa-external-link"></i></span></p>
<p>其实在上面的所有测试中其<strong>返回值都是完全的装配到了实体对象</strong>中,但是有的时候 比如有个<strong>字段</strong>很大 很消耗内存,同时也<strong>用不到</strong>,那么我<strong>如何</strong>把他<strong>取消</strong>掉.设置返回值为我们需要的几个字段就好</p>
<p><code>select()</code>测试</p>
<h5 id="注意坑-在借用-lambda-使用-lambda特性时"><a href="#注意坑-在借用-lambda-使用-lambda特性时" class="headerlink" title="注意坑  在借用 lambda() 使用 lambda特性时!"></a><strong>注意坑</strong>  在借用 <code>lambda()</code> 使用 lambda特性时!</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  测试 QueryWrapper.select()</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"> <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_Select</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line"><span class="comment">//        userQueryWrapper.eq("age",18)</span></span><br><span class="line"><span class="comment">//                .select("id","name");</span></span><br><span class="line">        userQueryWrapper.eq(<span class="string">"age"</span>,<span class="number">18</span>)</span><br><span class="line">                .select(User.class,i -&gt; <span class="keyword">false</span>);<span class="comment">//只返回id</span></span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);</span><br><span class="line">            <span class="comment">// SELECT id FROM user WHERE age = ?</span></span><br><span class="line">        userList.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//前方有坑 注意: 注意!!!!!!!!!!!</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//关于LambdaQueryWrapper的使用这样用是没问题的</span></span><br><span class="line">        LambdaQueryWrapper&lt;User&gt; lambdaQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;User&gt;().lambda();</span><br><span class="line">        lambdaQueryWrapper.select(User::getId,User::getAge);</span><br><span class="line">        List&lt;User&gt; userList1 = userMapper.selectList(lambdaQueryWrapper);</span><br><span class="line">            <span class="comment">//SELECT id,age FROM user</span></span><br><span class="line">        userList1.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 这样设置是无效的!!!!</span></span><br><span class="line">        QueryWrapper&lt;User&gt; userQueryWrapper2 = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        userQueryWrapper2.lambda().select(User::getId,User::getAge);</span><br><span class="line">        List&lt;User&gt; userList2 = userMapper.selectList(userQueryWrapper2);</span><br><span class="line">            <span class="comment">// SELECT id,name,age,email FROM user</span></span><br><span class="line">        userList2.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><code>set() setSql()</code> 测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    *  测试 UpdateWrapper.set()</span></span><br><span class="line"><span class="comment">    *  测试 UpdateWrapper.setSql()</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractWrapperTest_Set</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       UpdateWrapper&lt;User&gt; userUpdateWrapper = <span class="keyword">new</span> UpdateWrapper&lt;&gt;();</span><br><span class="line">       <span class="comment">// 更新id==11 的age 为19</span></span><br><span class="line">       userUpdateWrapper.set(<span class="string">"age"</span>,<span class="number">19</span>).eq(<span class="string">"id"</span>,<span class="number">11</span>);</span><br><span class="line">       <span class="comment">// 附加更新内容 name 设置</span></span><br><span class="line">       User user = <span class="keyword">new</span> User();</span><br><span class="line">       user.setName(<span class="string">"Lynwood1"</span>);</span><br><span class="line">       userMapper.update(user,userUpdateWrapper);</span><br><span class="line">       <span class="comment">/**</span></span><br><span class="line"><span class="comment">        *          ==&gt;  Preparing: UPDATE user SET name=?, age=? WHERE id = ?</span></span><br><span class="line"><span class="comment">        *          ==&gt; Parameters: Lynwood1(String), 19(Integer), 11(Integer)</span></span><br><span class="line"><span class="comment">        *          &lt;==    Updates: 1</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line"></span><br><span class="line">       UpdateWrapper&lt;User&gt; userUpdateWrapper1 = <span class="keyword">new</span> UpdateWrapper&lt;&gt;();</span><br><span class="line">       userUpdateWrapper1.setSql(<span class="string">"name='wunian7yulian'"</span>).eq(<span class="string">"id"</span>,<span class="number">11</span>);</span><br><span class="line">       <span class="comment">// 附加更新内容为空时  不能传入null  需要传入空实体对象</span></span><br><span class="line">       userMapper.update(<span class="keyword">new</span> User(),userUpdateWrapper1);</span><br><span class="line">       <span class="comment">/**</span></span><br><span class="line"><span class="comment">        *      ==&gt;  Preparing: UPDATE user SET name='wunian7yulian' WHERE id = ?</span></span><br><span class="line"><span class="comment">        *      ==&gt; Parameters: 11(Integer)</span></span><br><span class="line"><span class="comment">        *      &lt;==    Updates: 1</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h2 id="六、插件及扩展"><a href="#六、插件及扩展" class="headerlink" title="六、插件及扩展"></a>六、插件及扩展</h2><h3 id="Demo代码地址：-4"><a href="#Demo代码地址：-4" class="headerlink" title="Demo代码地址："></a>Demo代码地址：</h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3d1bmlhbjd5dWxpYW4vTXliYXRpc1BsdXNEZW1vL3RyZWUvbWFzdGVyL21wX3BsdWdpbl9kZW1v" title="https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/mp_plugin_demo">https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/mp_plugin_demo<i class="fa fa-external-link"></i></span>    </p>
<p>初始化:</p>
<p>​    因为下面演示需要其他字段,所以<strong>重新创建</strong>一个便于Demo的合适的<strong>表</strong>格:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建简单表格</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="keyword">user</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`user`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT  <span class="keyword">COMMENT</span> <span class="string">'主键ID'</span>,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'姓名'</span>,</span><br><span class="line">  <span class="string">`age`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'年龄'</span>,</span><br><span class="line">  <span class="string">`email`</span> <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'邮箱'</span>，</span><br><span class="line">  <span class="string">`version`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'版本'</span>,</span><br><span class="line">  <span class="string">`del`</span> <span class="built_in">int</span>(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="number">0</span> <span class="keyword">COMMENT</span> <span class="string">'逻辑删除'</span>,</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">user</span> ( <span class="keyword">name</span>, age, email) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="string">'Jone'</span>, <span class="number">18</span>, <span class="string">'test1@test.com'</span>),</span><br><span class="line">(<span class="string">'Jack'</span>, <span class="number">20</span>, <span class="string">'test2@test.com'</span>),</span><br><span class="line">(<span class="string">'Tom'</span>, <span class="number">28</span>, <span class="string">'test3@test.com'</span>),</span><br><span class="line">(<span class="string">'Sandy'</span>, <span class="number">21</span>, <span class="string">'test4@test.com'</span>),</span><br><span class="line">(<span class="string">'Billie'</span>, <span class="number">24</span>, <span class="string">'test5@test.com'</span>),</span><br><span class="line">(<span class="string">'Lynwood'</span>, <span class="number">18</span>, <span class="string">'wunian_@hotmail.com'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="工程：-3"><a href="#工程：-3" class="headerlink" title="工程："></a>工程：</h3><h4 id="第一-–-gt-第四步、同上"><a href="#第一-–-gt-第四步、同上" class="headerlink" title="第一 –&gt;第四步、同上"></a>第一 –&gt;第四步、同上</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  datasource:</span></span><br><span class="line"><span class="attr">    driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">jdbc:mysql://127.0.0.1:3306/mp_demo_db?characterEncoding=utf-8</span></span><br><span class="line"><span class="attr">    username:</span> <span class="string">root</span></span><br><span class="line"><span class="attr">    password:</span> <span class="number">123456</span></span><br><span class="line"></span><br><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line"><span class="attr">  global-config:</span></span><br><span class="line"><span class="attr">    db-config:</span></span><br><span class="line"><span class="attr">      id-type:</span> <span class="string">auto</span></span><br><span class="line"><span class="attr">  configuration:</span></span><br><span class="line"><span class="attr">    log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure>
<h4 id="第五步、插件使用"><a href="#第五步、插件使用" class="headerlink" title="第五步、插件使用"></a>第五步、插件使用</h4><h5 id="分页插件"><a href="#分页插件" class="headerlink" title="分页插件:"></a>分页插件:</h5><p>​    之前做列表或者报表功能时使用最多的是<code>pageHelper</code>插件做Mybatis的分页查询,MP为了方便将分页做了一个相关的模块<code>com.baomidou.mybatisplus.extension.plugins.pagination</code>供我们分页查询时去使用.</p>
<h6 id="1、创建一个MP插件的配置类"><a href="#1、创建一个MP插件的配置类" class="headerlink" title="1、创建一个MP插件的配置类:"></a>1、创建一个MP插件的配置类:</h6><p>在business目录下创建config目录 并在该目录下创建<code>MybatisPlusConfig.java</code>  添加<code>@Configuration</code>注解声明</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisPlusConfig</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="2、配置分页插件"><a href="#2、配置分页插件" class="headerlink" title="2、配置分页插件"></a>2、配置分页插件</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisPlusConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PaginationInterceptor <span class="title">paginationInterceptor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> PaginationInterceptor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="3、编写测试"><a href="#3、编写测试" class="headerlink" title="3、编写测试"></a>3、编写测试</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MpPluginDemoApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试分页插件</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_page</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        IPage&lt;User&gt; userIPage = userMapper.selectPage(</span><br><span class="line">                  <span class="keyword">new</span> Page&lt;User&gt;()</span><br><span class="line">                        .setCurrent(<span class="number">1</span>) <span class="comment">//设置当前查询页</span></span><br><span class="line">                        .setSize(<span class="number">3</span>) <span class="comment">// 设置每页条数</span></span><br><span class="line">                        .setDesc(<span class="string">"age"</span>),<span class="comment">//使用page 进行排序</span></span><br><span class="line">                <span class="keyword">new</span> QueryWrapper&lt;User&gt;()</span><br><span class="line">                        .lambda()</span><br><span class="line">                        .likeRight(User::getEmail, <span class="string">"test"</span>)</span><br><span class="line">                        .select(User::getId, User::getName, User::getAge)</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        List&lt;User&gt; records = userIPage.getRecords();</span><br><span class="line">        records.forEach(System.out::println);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * ==&gt;  Preparing: SELECT id,name,age FROM user WHERE email LIKE ? ORDER BY age DESC LIMIT ?,?</span></span><br><span class="line"><span class="comment">         * ==&gt; Parameters: test%(String), 0(Long), 3(Long)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>完美!  不过因为<code>page</code>对象在<code>3.0.6</code>版本还没有支持lambda方式 page上在设置排序字段时 还是会有一些魔法值出现,不过我们也是可以直接将 排序 写在wrapper里的.  有强迫症的童鞋等待<code>3.1.0</code>版本吧.</p>
<h5 id="逻辑删除插件"><a href="#逻辑删除插件" class="headerlink" title="逻辑删除插件:"></a>逻辑删除插件:</h5><h6 id="1、yaml添加逻辑值制定配置："><a href="#1、yaml添加逻辑值制定配置：" class="headerlink" title="1、yaml添加逻辑值制定配置："></a>1、yaml添加逻辑值制定配置：</h6><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  datasource:</span></span><br><span class="line"><span class="attr">    driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">jdbc:mysql://127.0.0.1:3306/mp_demo_db?characterEncoding=utf-8</span></span><br><span class="line"><span class="attr">    username:</span> <span class="string">root</span></span><br><span class="line"><span class="attr">    password:</span> <span class="number">123456</span></span><br><span class="line"></span><br><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line"><span class="attr">  global-config:</span></span><br><span class="line"><span class="attr">    db-config:</span></span><br><span class="line"><span class="attr">      id-type:</span> <span class="string">auto</span></span><br><span class="line"><span class="attr">      logic-delete-value:</span> <span class="number">1</span> <span class="comment"># 逻辑已删除值(默认为 1)</span></span><br><span class="line"><span class="attr">      logic-not-delete-value:</span> <span class="number">0</span> <span class="comment"># 逻辑未删除值(默认为 0)</span></span><br><span class="line"><span class="attr">  configuration:</span></span><br><span class="line"><span class="attr">    log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure>
<h6 id="2、配置逻辑插件"><a href="#2、配置逻辑插件" class="headerlink" title="2、配置逻辑插件:"></a>2、配置逻辑插件:</h6><p>在MybatisPlusConfig中添加插件bean</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisPlusConfig</span> </span>&#123;</span><br><span class="line"> 	...</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ISqlInjector <span class="title">sqlInjector</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> LogicSqlInjector();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="3、标识逻辑字段"><a href="#3、标识逻辑字段" class="headerlink" title="3、标识逻辑字段:"></a>3、标识逻辑字段:</h6><p>在<code>User</code>中的 del字段上添加<code>@TableLogic</code>注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode</span>(callSuper = <span class="keyword">false</span>)</span><br><span class="line"><span class="meta">@Accessors</span>(chain = <span class="keyword">true</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">	...</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 逻辑删除 0-未删除 1-删除</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableLogic</span></span><br><span class="line">    <span class="keyword">private</span> Integer del;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="4、编写测试"><a href="#4、编写测试" class="headerlink" title="4、编写测试"></a>4、编写测试</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 测试逻辑删除插件</span></span><br><span class="line"><span class="comment">    */</span> </span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_logic_delete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       userMapper.delete(<span class="keyword">new</span> QueryWrapper&lt;User&gt;()</span><br><span class="line">               .lambda()</span><br><span class="line">               .notLike(User::getEmail, <span class="string">"test"</span>)</span><br><span class="line">               .select(User::getId, User::getName, User::getAge));</span><br><span class="line">       <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * ==&gt;  Preparing: UPDATE user SET del=1 WHERE del=0 AND email NOT LIKE ?</span></span><br><span class="line"><span class="comment">        * ==&gt; Parameters: %test%(String)</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">       <span class="comment">//那么查询呢?</span></span><br><span class="line">       List&lt;User&gt; userList = userMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">       userList.forEach(System.out::println);</span><br><span class="line">       <span class="comment">//发现查询也帮我们设置了过滤字段  del = 0</span></span><br><span class="line">       <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * ==&gt;  Preparing: SELECT id,name,age,email,del,version FROM user WHERE del=0</span></span><br><span class="line"><span class="comment">        * ==&gt; Parameters:</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">//那么我想查出这个删除的用户 更改为 正常呢?</span></span><br><span class="line">       List&lt;Map&lt;String, Object&gt;&gt; mapList = userMapper.selectMaps(</span><br><span class="line">               <span class="keyword">new</span> QueryWrapper&lt;User&gt;()</span><br><span class="line">                       .lambda()</span><br><span class="line">                       .eq(User::getDel, <span class="number">1</span>)</span><br><span class="line">                       .select(User.class,i -&gt; <span class="keyword">false</span>)</span><br><span class="line">       );</span><br><span class="line">       Assert.assertNotNull(mapList);</span><br><span class="line">       Assert.assertEquals(mapList.size(),<span class="number">1</span>);</span><br><span class="line">       <span class="comment">/**  select id from user where del = 0 and del = 1</span></span><br><span class="line"><span class="comment">        * java.lang.AssertionError:</span></span><br><span class="line"><span class="comment">        * Expected :0</span></span><br><span class="line"><span class="comment">        * Actual   :1</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">       <span class="comment">// 失败了</span></span><br><span class="line">       <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>询问MP开发者后 开发者说明 因为大部分情况在删除之后不会恢复 所以<strong>没有设定相关恢复或者跳过 当前 筛选的</strong> 接口</p>
<h5 id="乐观锁"><a href="#乐观锁" class="headerlink" title="乐观锁:"></a>乐观锁:</h5><h6 id="主要适用场景"><a href="#主要适用场景" class="headerlink" title="主要适用场景"></a>主要适用场景</h6><p>当要更新一条记录的时候，希望这条记录没有被别人更新</p>
<p>特别说明:</p>
<ul>
<li><strong>支持的数据类型只有:int,Integer,long,Long,Date,Timestamp,LocalDateTime</strong></li>
<li>整数类型下 <code>newVersion = oldVersion + 1</code></li>
<li><code>newVersion</code> 会回写到 <code>entity</code> 中</li>
<li><strong>仅支持</strong> <code>updateById(id)</code> 与 <code>update(entity, wrapper)</code> 方法</li>
<li><strong>在 update(entity, wrapper) 方法下, wrapper 不能复用!!!</strong></li>
</ul>
<p>乐观锁实现方式：</p>
<ul>
<li>取出记录时，获取当前version</li>
<li>更新时，带上这个version</li>
<li>执行更新时， set version = newVersion where version = oldVersion</li>
<li>如果version不对，就更新失败</li>
</ul>
<p>1、配置乐观锁插件：</p>
<p>在<code>MybatisPlusConfig</code>添加：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> OptimisticLockerInterceptor <span class="title">optimisticLockerInterceptor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> OptimisticLockerInterceptor();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2、添加乐观锁版本字段注解:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode</span>(callSuper = <span class="keyword">false</span>)</span><br><span class="line"><span class="meta">@Accessors</span>(chain = <span class="keyword">true</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">	...</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 乐观锁版本字段</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Version</span></span><br><span class="line">    <span class="keyword">private</span> Integer version;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3、编写测试类: </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试乐观锁插件</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_Optimistic_Locking</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        User oldUser = userMapper.selectById(<span class="number">1</span>);</span><br><span class="line">        oldUser.setAge(<span class="number">19</span>);</span><br><span class="line">        System.out.println(<span class="string">"模拟中途有人更改"</span>+ <span class="string">"begin...."</span>);</span><br><span class="line">        Thread.sleep(<span class="number">10000</span>);</span><br><span class="line">        System.out.println(<span class="string">"模拟中途有人更改"</span>+ <span class="string">"end...."</span>);</span><br><span class="line">        <span class="keyword">if</span>(userMapper.updateById(oldUser)==<span class="number">1</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">"success \n"</span>+ oldUser);</span><br><span class="line">            <span class="comment">//success</span></span><br><span class="line">            <span class="comment">//User(id=1, name=Jone, age=19, email=test1@test.com, del=0, version=2)</span></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"fail \n"</span>);</span><br><span class="line">            <span class="comment">//==&gt;  Preparing: UPDATE user SET name=?, age=?, email=?, version=? WHERE id=? AND version=? AND del=0</span></span><br><span class="line">            <span class="comment">//==&gt; Parameters: Jone(String), 19(Integer), test1@test.com(String), 3(Integer), 1(Long), 2(Integer)</span></span><br><span class="line">            <span class="comment">//&lt;==    Updates: 0</span></span><br><span class="line">            <span class="comment">//fail</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>其他插件 如 热加载等 如有需要 再做更新</p>
<h2 id="七-、总结"><a href="#七-、总结" class="headerlink" title="七 、总结"></a>七 、总结</h2><p>MP优秀于简化了Mybatis大部分XML配置 将他归总到起来生成一个强大的Wrapper </p>
<p>现有MP也是有了两个版本大的版本2.x与3.x ,酌情使用比较合理 3.x虽然有了Lambda的支持但是还不完善,</p>
<p>后续版本的更新应该也会去查漏现版本的缺陷.</p>
<p>对于插件,像乐观锁分页逻辑删真的是贴心,不过也有相对应场景不适用问题,比如上面说到的逻辑删除的我还要查是查不到的,还是需要去自定义sql的</p>
<p>我相信 有了mp这种强大的利器,对于一个微型项目 或者微服务 来说真的是爽,写起来真的是非常有效率</p>
<p>个人–    </p>
<p>​    作为头一个被我收拾的应用层框架,看到了开发者的用心和初心, 看来排上名并不是那么绝非偶然,也并非那么”功力深厚”,只要你有想法开始做,总有一个好的结果.</p>
<p>下一框架寻找中… </p>
<h2 id="参考文档："><a href="#参考文档：" class="headerlink" title="参考文档："></a>参考文档：</h2><blockquote>
<p>MyBatis-Plus 官方文档 : <span class="exturl" data-url="aHR0cHM6Ly9tcC5iYW9taWRvdS5jb20v" title="https://mp.baomidou.com/">https://mp.baomidou.com/<i class="fa fa-external-link"></i></span> </p>
<p>MyBatis-Plus 配置进阶 : <span class="exturl" data-url="aHR0cHM6Ly9tcC5iYW9taWRvdS5jb20vY29uZmlnLw==" title="https://mp.baomidou.com/config/">https://mp.baomidou.com/config/<i class="fa fa-external-link"></i></span> </p>
<p>MyBatis-Plus 代码生成器配置 : <span class="exturl" data-url="aHR0cHM6Ly9tcC5iYW9taWRvdS5jb20vY29uZmlnL2dlbmVyYXRvci1jb25maWcuaHRtbA==" title="https://mp.baomidou.com/config/generator-config.html">https://mp.baomidou.com/config/generator-config.html<i class="fa fa-external-link"></i></span> </p>
<p>MyBatis-Plus sql注入原理 :  <span class="exturl" data-url="aHR0cHM6Ly93d3cubGlhbmd6bC5jb20vZ2V0LWFydGljbGUtZGV0YWlsLTE5ODMxLmh0bWw=" title="https://www.liangzl.com/get-article-detail-19831.html">https://www.liangzl.com/get-article-detail-19831.html<i class="fa fa-external-link"></i></span> </p>
<p>Mybatis-Plus 使用全解 : <span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC83Mjk5Y2JhMmFkZWM=" title="https://www.jianshu.com/p/7299cba2adec">https://www.jianshu.com/p/7299cba2adec<i class="fa fa-external-link"></i></span> </p>
</blockquote>

      
    </div>
    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    wunian7yulian
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/" title="'MyBatis-Plus我来填坑'">https://wunian7yulian.top/2019/04/04/MyBatis-Plus我来填坑/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      

      
      
        <div class="post-widgets">
        

        

        
          
          <div id="needsharebutton-postbottom">
            <span class="btn">
              <i class="fa fa-share-alt" aria-hidden="true"></i>
            </span>
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/01/01/2019定制个人博客规划/" rel="next" title="2019定制个人博客规划">
                <i class="fa fa-chevron-left"></i> 2019定制个人博客规划
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div id="gitalk-container"></div>
    </div>
 




        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="wunian7yulian">
            
              <p class="site-author-name" itemprop="name">wunian7yulian</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

			<!--my custom code begin-->
			<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.5.0/velocity.min.js"></script>
			<script type="text/javascript">
			  $("#sidebar").hover(function(){
				$("#mydivshow").velocity('stop').velocity({opacity: 1});
			  },function(){
				$("#mydivshow").velocity('stop').velocity({opacity: 0});
			  });
			</script>
			<div id="mydivshow" class="mydivshow">
			<!--my custom code end-->
			
          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/wunian7yulian" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:wunian_@hotmail.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            
          </div>

          
          

          
          

          <div id="player1" class="aplayer"></div>
<script src="/js/src/APlayer.min.js"></script>
<script type="text/javascript">
var ap = new APlayer({
    element: document.getElementById('player1'),                       // Optional, player element
    narrow: false,                                                     // Optional, narrow style
    autoplay: false,                                                    // Optional, autoplay song(s), not supported by mobile browsers
    showlrc: 0,                                                        // Optional, show lrc, can be 0, 1, 2, see: ###With lrc
    mutex: true,                                                       // Optional, pause other players when this player playing
    theme: '#e6d0b2',                                                  // Optional, theme color, default: #b7daff
    mode: 'random',                                                    // Optional, play mode, can be `random` `single` `circulation`(loop) `order`(no loop), default: `circulation`
    preload: 'metadata',                                               // Optional, the way to load music, can be 'none' 'metadata' 'auto', default: 'auto'
    listmaxheight: '513px',                                             // Optional, max height of play list
    music: {                                                           // Required, music info, see: ###With playlist
        title: '人间',                                          // Required, music title
        author: 'cover',                          // Required, music author
        url: '/music/renjian.mp3',  // Required, music url
        pic: '/images/renjianpic.jpg',  // Optional, music picture
    }
});
</script>
        </div>
		<!--my custom code begin-->
		</div>
		<!--my custom code end-->
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Mybatis-Plus-我来填坑"><span class="nav-number">1.</span> <span class="nav-text">Mybatis-Plus 我来填坑~</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#简介："><span class="nav-number">1.0.0.1.</span> <span class="nav-text">简介：</span></a></li></ol></li></ol><li class="nav-item nav-level-2"><a class="nav-link" href="#目录"><span class="nav-number">1.1.</span> <span class="nav-text">目录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#一、简单介绍"><span class="nav-number">1.2.</span> <span class="nav-text">一、简单介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#官方说明-："><span class="nav-number">1.2.1.</span> <span class="nav-text">官方说明 ：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#润物无声"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">润物无声</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#效率至上"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">效率至上</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#丰富功能"><span class="nav-number">1.2.1.3.</span> <span class="nav-text">丰富功能</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#成绩："><span class="nav-number">1.2.2.</span> <span class="nav-text">成绩：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#最新版本："><span class="nav-number">1.2.3.</span> <span class="nav-text">最新版本：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#开发层面MyBatis-Plus特色"><span class="nav-number">1.2.4.</span> <span class="nav-text">开发层面MyBatis-Plus特色</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mybatis-Plus中的Plus"><span class="nav-number">1.2.5.</span> <span class="nav-text">Mybatis-Plus中的Plus</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、MP的特性"><span class="nav-number">1.3.</span> <span class="nav-text">二、MP的特性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、MP框架结构"><span class="nav-number">1.4.</span> <span class="nav-text">三、MP框架结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、简单的入门Demo-Mysql"><span class="nav-number">1.5.</span> <span class="nav-text">四、简单的入门Demo(Mysql)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Demo代码地址："><span class="nav-number">1.5.0.1.</span> <span class="nav-text">Demo代码地址：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Demo-环境："><span class="nav-number">1.5.0.2.</span> <span class="nav-text">Demo 环境：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#初始化："><span class="nav-number">1.5.0.3.</span> <span class="nav-text">初始化：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#数据库：MySql"><span class="nav-number">1.5.0.3.1.</span> <span class="nav-text">数据库：MySql</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#DDL"><span class="nav-number">1.5.0.3.1.1.</span> <span class="nav-text">DDL:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#DML"><span class="nav-number">1.5.0.3.1.2.</span> <span class="nav-text">DML:</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#工程："><span class="nav-number">1.5.0.4.</span> <span class="nav-text">工程：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#第一步、创建工程"><span class="nav-number">1.5.0.4.1.</span> <span class="nav-text">第一步、创建工程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第二步、引入依赖坐标"><span class="nav-number">1.5.0.4.2.</span> <span class="nav-text">第二步、引入依赖坐标</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第三步、配置数据源"><span class="nav-number">1.5.0.4.3.</span> <span class="nav-text">第三步、配置数据源</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第四步、添加mybatis扫描位置"><span class="nav-number">1.5.0.4.4.</span> <span class="nav-text">第四步、添加mybatis扫描位置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第五步、pojo及mapper"><span class="nav-number">1.5.0.4.5.</span> <span class="nav-text">第五步、pojo及mapper</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第六步、测试"><span class="nav-number">1.5.0.4.6.</span> <span class="nav-text">第六步、测试</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#五、核心功能"><span class="nav-number">1.6.</span> <span class="nav-text">五、核心功能</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#核心一-简便之-代码生成器（AutoGenerator）"><span class="nav-number">1.6.1.</span> <span class="nav-text">核心一-简便之-代码生成器（AutoGenerator）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Demo代码地址：-1"><span class="nav-number">1.6.1.1.</span> <span class="nav-text">Demo代码地址：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Demo-环境：-1"><span class="nav-number">1.6.1.2.</span> <span class="nav-text">Demo 环境：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#工程：-1"><span class="nav-number">1.6.1.3.</span> <span class="nav-text">工程：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#第一步、创建模块"><span class="nav-number">1.6.1.3.1.</span> <span class="nav-text">第一步、创建模块</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第二步、引入依赖坐标-1"><span class="nav-number">1.6.1.3.2.</span> <span class="nav-text">第二步、引入依赖坐标</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第三步、编写代码生成器"><span class="nav-number">1.6.1.3.3.</span> <span class="nav-text">第三步、编写代码生成器</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第四步、运行测试"><span class="nav-number">1.6.1.3.4.</span> <span class="nav-text">第四步、运行测试</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#发现问题：-如果是多模块项目-生成的文件会直接到了父项目目录下"><span class="nav-number">1.6.1.3.5.</span> <span class="nav-text">发现问题： 如果是多模块项目 生成的文件会直接到了父项目目录下</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#解决方法："><span class="nav-number">1.6.1.3.5.1.</span> <span class="nav-text">解决方法：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#核心二-清晰之-CRUD接口"><span class="nav-number">1.6.2.</span> <span class="nav-text">核心二 - 清晰之-CRUD接口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Demo代码地址：-2"><span class="nav-number">1.6.2.1.</span> <span class="nav-text">Demo代码地址：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#工程：-2"><span class="nav-number">1.6.2.2.</span> <span class="nav-text">工程：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#第一步、创建模块-1"><span class="nav-number">1.6.2.2.1.</span> <span class="nav-text">第一步、创建模块</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第二步、引入依赖坐标-2"><span class="nav-number">1.6.2.2.2.</span> <span class="nav-text">第二步、引入依赖坐标</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第三步、生成代码"><span class="nav-number">1.6.2.2.3.</span> <span class="nav-text">第三步、生成代码</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第四步、其他配置需要"><span class="nav-number">1.6.2.2.4.</span> <span class="nav-text">第四步、其他配置需要</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第五步、对MP探个究竟！"><span class="nav-number">1.6.2.2.5.</span> <span class="nav-text">第五步、对MP探个究竟！</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#发现问题-我虽然看到了方法-但是并没有一条SQL-那么它是怎样做到查询的呢"><span class="nav-number">1.6.2.2.6.</span> <span class="nav-text">发现问题:  我虽然看到了方法 但是并没有一条SQL 那么它是怎样做到查询的呢?</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#探索"><span class="nav-number">1.6.2.2.6.1.</span> <span class="nav-text">探索:</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第六步、使用它"><span class="nav-number">1.6.2.2.7.</span> <span class="nav-text">第六步、使用它</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Mapper-简单的CRUD"><span class="nav-number">1.6.2.2.7.1.</span> <span class="nav-text">Mapper - 简单的CRUD:</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#发现问题-虽然MP替我生成了-uuid-作为主键-但是还是想用数据库自增形式主键怎么办"><span class="nav-number">1.6.2.2.8.</span> <span class="nav-text">发现问题: 虽然MP替我生成了 uuid 作为主键,但是还是想用数据库自增形式主键怎么办?</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#解决"><span class="nav-number">1.6.2.2.8.1.</span> <span class="nav-text">解决:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Mapper-批量的CRUD接口"><span class="nav-number">1.6.2.2.8.2.</span> <span class="nav-text">Mapper - 批量的CRUD接口:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Mapper-选装组件"><span class="nav-number">1.6.2.2.8.3.</span> <span class="nav-text">Mapper - 选装组件:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Service-CRUD"><span class="nav-number">1.6.2.2.8.4.</span> <span class="nav-text">Service - CRUD:</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#核心三-强大之-Wrapper条件构造器"><span class="nav-number">1.6.3.</span> <span class="nav-text">核心三 - 强大之 -Wrapper条件构造器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Demo代码地址：-3"><span class="nav-number">1.6.3.1.</span> <span class="nav-text">Demo代码地址：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#工程"><span class="nav-number">1.6.3.2.</span> <span class="nav-text">工程:</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#第一-–-gt-第四步-同上一工程步骤"><span class="nav-number">1.6.3.2.1.</span> <span class="nav-text">第一 –&gt;第四步 同上一工程步骤</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第五步、探索Wrapper"><span class="nav-number">1.6.3.2.2.</span> <span class="nav-text">第五步、探索Wrapper</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Wrapper含义"><span class="nav-number">1.6.3.2.2.1.</span> <span class="nav-text">Wrapper含义:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#版本不同"><span class="nav-number">1.6.3.2.2.2.</span> <span class="nav-text">版本不同:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-x-Wrapper主要继承结构"><span class="nav-number">1.6.3.2.2.3.</span> <span class="nav-text">3.x Wrapper主要继承结构:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#AbstractWrapper接口"><span class="nav-number">1.6.3.2.2.4.</span> <span class="nav-text">AbstractWrapper接口:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#AbstractWrapper接口-1"><span class="nav-number">1.6.3.2.2.5.</span> <span class="nav-text">AbstractWrapper接口:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#UpdateWrapper接口"><span class="nav-number">1.6.3.2.2.6.</span> <span class="nav-text">UpdateWrapper接口:</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第六步、使用接口"><span class="nav-number">1.6.3.2.3.</span> <span class="nav-text">第六步、使用接口</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#打印SQL日志配置"><span class="nav-number">1.6.3.2.3.1.</span> <span class="nav-text">##打印SQL日志配置</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#一-gt-编写AbstractWrapper测试类"><span class="nav-number">1.6.3.2.3.2.</span> <span class="nav-text">一&gt; 编写AbstractWrapper测试类:</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#发现问题-boolean-condition-、R-column和-Function-lt-This-This-gt-func-三个参数相关问题"><span class="nav-number">1.6.3.2.4.</span> <span class="nav-text">发现问题: boolean condition 、R column和 Function&lt;This, This&gt; func 三个参数相关问题</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#说明及使用"><span class="nav-number">1.6.3.2.4.1.</span> <span class="nav-text">说明及使用:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#1-关于入参-boolean-condition"><span class="nav-number">1.6.3.2.4.2.</span> <span class="nav-text">1.关于入参: boolean condition</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-关于入参-R-column"><span class="nav-number">1.6.3.2.4.3.</span> <span class="nav-text">2.关于入参: R column</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#lambda"><span class="nav-number">1.6.4.</span> <span class="nav-text">lambda</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#3-关于入参-Function-lt-This-This-gt-func"><span class="nav-number">1.6.4.0.0.1.</span> <span class="nav-text">3.关于入参: Function&lt;This, This&gt; func</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#二-gt-编写QueryWrapper与UpdateWrapper测试类"><span class="nav-number">1.6.4.0.0.2.</span> <span class="nav-text">二&gt; 编写QueryWrapper与UpdateWrapper测试类:</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#注意坑-在借用-lambda-使用-lambda特性时"><span class="nav-number">1.6.4.0.1.</span> <span class="nav-text">注意坑  在借用 lambda() 使用 lambda特性时!</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#六、插件及扩展"><span class="nav-number">1.7.</span> <span class="nav-text">六、插件及扩展</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Demo代码地址：-4"><span class="nav-number">1.7.1.</span> <span class="nav-text">Demo代码地址：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#工程：-3"><span class="nav-number">1.7.2.</span> <span class="nav-text">工程：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#第一-–-gt-第四步、同上"><span class="nav-number">1.7.2.1.</span> <span class="nav-text">第一 –&gt;第四步、同上</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#第五步、插件使用"><span class="nav-number">1.7.2.2.</span> <span class="nav-text">第五步、插件使用</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#分页插件"><span class="nav-number">1.7.2.2.1.</span> <span class="nav-text">分页插件:</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1、创建一个MP插件的配置类"><span class="nav-number">1.7.2.2.1.1.</span> <span class="nav-text">1、创建一个MP插件的配置类:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2、配置分页插件"><span class="nav-number">1.7.2.2.1.2.</span> <span class="nav-text">2、配置分页插件</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3、编写测试"><span class="nav-number">1.7.2.2.1.3.</span> <span class="nav-text">3、编写测试</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#逻辑删除插件"><span class="nav-number">1.7.2.2.2.</span> <span class="nav-text">逻辑删除插件:</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1、yaml添加逻辑值制定配置："><span class="nav-number">1.7.2.2.2.1.</span> <span class="nav-text">1、yaml添加逻辑值制定配置：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2、配置逻辑插件"><span class="nav-number">1.7.2.2.2.2.</span> <span class="nav-text">2、配置逻辑插件:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3、标识逻辑字段"><span class="nav-number">1.7.2.2.2.3.</span> <span class="nav-text">3、标识逻辑字段:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4、编写测试"><span class="nav-number">1.7.2.2.2.4.</span> <span class="nav-text">4、编写测试</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#乐观锁"><span class="nav-number">1.7.2.2.3.</span> <span class="nav-text">乐观锁:</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#主要适用场景"><span class="nav-number">1.7.2.2.3.1.</span> <span class="nav-text">主要适用场景</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#七-、总结"><span class="nav-number">1.8.</span> <span class="nav-text">七 、总结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考文档："><span class="nav-number">1.9.</span> <span class="nav-text">参考文档：</span></a></li></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </main></div>
    

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">wunian7yulian</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">10.4k</span>
  
</div>






  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a></div>



<span id="busuanzi_container_site_pv">
  本站总访问量<span id="busuanzi_value_site_pv"></span>次
</span>
<span id="busuanzi_container_site_uv">
  本站访客数<span id="busuanzi_value_site_uv"></span>人次
</span>
        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  
  
    
  

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>




  


  




	





  





  






  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
   <script type="text/javascript">
        var gitalk = new Gitalk({
          clientID: 'b02e63283a5c68c4d05f',
          clientSecret: '4c80a17308a73cfb487b156833cb719faa7aa388',
          repo: 'wunian7yulian.github.io',
          owner: 'wunian7yulian',
          admin: ['wunian7yulian'],
          id: decodeURI(location.pathname),
          distractionFreeMode: 'true'
        })
        gitalk.render('gitalk-container')           
       </script>






  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("gXniWujhVbh0kvT59eF82Jq1-gzGzoHsz", "hob2PMaITEmDwlplkiiTwL6X");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>

  

  
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.3"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.3"></script>


  
  <script type="text/javascript" src="/js/src/exturl.js?v=5.1.3"></script>


  <script src="/js/src/Aplayer-Controler.js"></script>
<div id="AP-controler"></div>
<script type="text/javascript">
var myapc=new APlayer_Controler({
		APC_dom:$('#AP-controler'),
		aplayer:ap, //此为绑定的aplayer对象
		attach_right:false,
		position:{top:'300px',bottom:''},
		fixed:true,
		btn_width:100,
		btn_height:120,
		img_src:['http://oty1v077k.bkt.clouddn.com/bukagirl.jpg',
				'http://oty1v077k.bkt.clouddn.com/jumpgirl.jpg',
				'http://oty1v077k.bkt.clouddn.com/pentigirl.jpg',
				'http://oty1v077k.bkt.clouddn.com/%E8%90%8C1.gif'],
		img_style:{repeat:'no-repeat',position:'center',size:'contain'},
		ctrls_color:'rgba(173,255,47,0.8)',
		ctrls_hover_color:'rgba(255,140,0,0.7)',
		tips_on:true,
		tips_width:140,
		tips_height:25,
		tips_color:'rgba(255,255,255,0.6)',
		tips_content:{},
		timeout:30
	});
</script>
  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>



</body>
</html>
